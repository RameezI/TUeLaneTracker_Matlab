<pre class="code">
<span class="srcline"><span class="lineno"><a href="104,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%% create edge template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,8" id="srcline8">  8</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T3U3">TEMPLATE</span>] = createTemplate( <span class="var type1" id="S3T15U6">H</span> ,<span class="var type1" id="S4T15U7">W</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="104,9" id="srcline9">  9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,10" id="srcline10"> 10</a></span><span class="line">    <span class="comment">%% empty template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,11" id="srcline11"> 11</a></span><span class="line">    <span class="mxinfo " id="T3:U4"><span class="var type1" id="S2T3U10">TEMPLATE</span> = <span class="mxinfo " id="T3:U6"><span class="mxinfo " id="T6:U7">-180</span> * <span class="mxinfo " id="T3:U8">ones( <span class="mxinfo " id="T15:U9"><span class="mxinfo " id="T15:U10">2*<span class="var type1" id="S3T15U19">H</span></span>+<span class="mxinfo " id="T6:U12">1</span></span>, <span class="mxinfo " id="T15:U13"><span class="mxinfo " id="T15:U14">2*<span class="var type1" id="S4T15U24">W</span></span>+<span class="mxinfo " id="T6:U16">1</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo " id="T42:U17"><span class="var type1" id="S6T42U28">pix</span>      = <span class="mxinfo " id="T42:U19">[<span class="mxinfo " id="T16:U20"><span class="mxinfo " id="T15:U21">-2*<span class="var type1" id="S4T15U35">W</span></span>:<span class="mxinfo " id="T15:U23">2*<span class="var type1" id="S4T15U38">W</span></span></span>;<span class="mxinfo " id="T18:U25">zeros(<span class="mxinfo " id="T6:U26">1</span>,<span class="mxinfo " id="T15:U27"><span class="mxinfo " id="T15:U28">4*<span class="var type1" id="S4T15U46">W</span></span>+<span class="mxinfo " id="T6:U30">1</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,13" id="srcline13"> 13</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="104,14" id="srcline14"> 14</a></span><span class="line">    <span class="comment">%% left border</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,15" id="srcline15"> 15</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S8T15U50">h</span> = <span class="mxinfo " id="T15:U32"><span class="var type1" id="S3T15U53">H</span>+<span class="mxinfo " id="T6:U34">1</span></span>:<span class="mxinfo " id="T15:U35"><span class="mxinfo " id="T15:U36">2*<span class="var type1" id="S3T15U58">H</span></span>+<span class="mxinfo " id="T6:U38">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="104,16" id="srcline16"> 16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,17" id="srcline17"> 17</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,18" id="srcline18"> 18</a></span><span class="line">        <span class="mxinfo " id="T15:U39"><span class="var type1" id="S9T15U62">an</span> = <span class="mxinfo " id="T15:U41">atan( <span class="mxinfo " id="T15:U42">(<span class="mxinfo " id="T15:U43"><span class="var type1" id="S8T15U68">h</span>-(<span class="mxinfo " id="T15:U45"><span class="var type1" id="S3T15U71">H</span>+<span class="mxinfo " id="T6:U47">1</span></span>)</span>) / <span class="var type1" id="S4T15U73">W</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,19" id="srcline19"> 19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,20" id="srcline20"> 20</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,21" id="srcline21"> 21</a></span><span class="line">        <span class="mxinfo " id="T15:U49"><span class="var type1" id="S11T15U76">cs</span>     = <span class="mxinfo " id="T15:U51">cos(<span class="mxinfo " id="T15:U52">-<span class="var type1" id="S9T15U80">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="104,22" id="srcline22"> 22</a></span><span class="line">        <span class="mxinfo " id="T15:U54"><span class="var type1" id="S13T15U83">sn</span>     = <span class="mxinfo " id="T15:U56">sin(<span class="mxinfo " id="T15:U57">-<span class="var type1" id="S9T15U87">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,23" id="srcline23"> 23</a></span><span class="line">        <span class="mxinfo " id="T49:U59"><span class="var type1" id="S15T49U90">rot</span>    = <span class="mxinfo " id="T49:U61">[<span class="mxinfo " id="T14:U62"><span class="var type1" id="S11T15U93">cs</span> <span class="mxinfo " id="T15:U64">-<span class="var type1" id="S13T15U95">sn</span></span></span>; <span class="mxinfo " id="T14:U66"><span class="var type1" id="S13T15U97">sn</span> <span class="var type1" id="S11T15U98">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,24" id="srcline24"> 24</a></span><span class="line">        <span class="mxinfo " id="T42:U69"><span class="var type1" id="S16T42U101">pixrot</span> = <span class="mxinfo " id="T42:U71"><span class="var type1" id="S15T49U103">rot</span>*<span class="var type1" id="S6T42U104">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,25" id="srcline25"> 25</a></span><span class="line">        <span class="mxinfo " id="T16:U74"><span class="mxinfo " id="T16:U75"><span class="var type1" id="S16T42U108">pixrot</span>(<span class="mxinfo " id="T13:U77">1</span>,<span class="mxinfo " id="T17:U78">:</span>)</span> = <span class="mxinfo " id="T16:U79"><span class="mxinfo " id="T16:U80"><span class="mxinfo " id="T16:U81"><span class="var type1" id="S16T42U114">pixrot</span>(<span class="mxinfo " id="T6:U83">1</span>,<span class="mxinfo " id="T17:U84">:</span>)</span> + <span class="var type1" id="S4T15U117">W</span></span>+<span class="mxinfo " id="T6:U86">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,26" id="srcline26"> 26</a></span><span class="line">        <span class="mxinfo " id="T16:U87"><span class="mxinfo " id="T16:U88"><span class="var type1" id="S16T42U122">pixrot</span>(<span class="mxinfo " id="T13:U90">2</span>,<span class="mxinfo " id="T17:U91">:</span>)</span> = <span class="mxinfo " id="T16:U92"><span class="mxinfo " id="T16:U93"><span class="mxinfo " id="T16:U94"><span class="var type1" id="S16T42U128">pixrot</span>(<span class="mxinfo " id="T6:U96">2</span>,<span class="mxinfo " id="T17:U97">:</span>)</span> + <span class="var type1" id="S3T15U131">H</span></span>+<span class="mxinfo " id="T6:U99">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="104,27" id="srcline27"> 27</a></span><span class="line">        <span class="mxinfo " id="T42:U100"><span class="var type1" id="S16T42U135">pixrot</span>      = <span class="mxinfo " id="T42:U102"><span class="var type1" id="S16T42U137">pixrot</span>(<span class="mxinfo " id="T52:U104">:</span>, <span class="mxinfo " id="T118:U105"><span class="mxinfo " id="T118:U106"><span class="mxinfo " id="T118:U107">(<span class="mxinfo " id="T118:U108"><span class="mxinfo " id="T6:U109">1</span> &lt;= <span class="mxinfo " id="T16:U110"><span class="var type1" id="S16T42U146">pixrot</span>(<span class="mxinfo " id="T6:U112">1</span>,<span class="mxinfo " id="T17:U113">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T118:U114"><span class="mxinfo " id="T16:U115"><span class="var type1" id="S16T42U152">pixrot</span>(<span class="mxinfo " id="T6:U117">1</span>,<span class="mxinfo " id="T17:U118">:</span>)</span> &lt;= <span class="mxinfo " id="T15:U119"><span class="mxinfo " id="T15:U120">2*<span class="var type1" id="S4T15U158">W</span></span>+<span class="mxinfo " id="T6:U122">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T118:U123"><span class="mxinfo " id="T6:U124">1</span> &lt;= <span class="mxinfo " id="T16:U125"><span class="var type1" id="S16T42U164">pixrot</span>(<span class="mxinfo " id="T6:U127">2</span>,<span class="mxinfo " id="T17:U128">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T118:U129"><span class="mxinfo " id="T16:U130"><span class="var type1" id="S16T42U170">pixrot</span>(<span class="mxinfo " id="T6:U132">2</span>,<span class="mxinfo " id="T17:U133">:</span>)</span> &lt;= <span class="mxinfo " id="T15:U134"><span class="mxinfo " id="T15:U135">2*<span class="var type1" id="S3T15U176">H</span></span>+<span class="mxinfo " id="T6:U137">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,28" id="srcline28"> 28</a></span><span class="line">        <span class="mxinfo " id="T42:U138"><span class="var type1" id="S16T42U180">pixrot</span>      = <span class="mxinfo " id="T42:U140">round(<span class="var type1" id="S16T42U183">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,29" id="srcline29"> 29</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,30" id="srcline30"> 30</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,31" id="srcline31"> 31</a></span><span class="line">        <span class="mxinfo " id="T18:U142"><span class="var type1" id="S18T18U186">index</span> = <span class="mxinfo " id="T18:U144">sub2ind(<span class="mxinfo " id="T14:U145">[<span class="mxinfo " id="T15:U146"><span class="mxinfo " id="T15:U147">2*<span class="var type1" id="S3T15U194">H</span></span>+<span class="mxinfo " id="T6:U149">1</span></span>, <span class="mxinfo " id="T15:U150"><span class="mxinfo " id="T15:U151">2*<span class="var type1" id="S4T15U199">W</span></span>+<span class="mxinfo " id="T6:U153">1</span></span>]</span>, <span class="mxinfo " id="T16:U154"><span class="var type1" id="S16T42U202">pixrot</span>(<span class="mxinfo " id="T13:U156">2</span>,<span class="mxinfo " id="T17:U157">:</span>)</span>, <span class="mxinfo " id="T16:U158"><span class="var type1" id="S16T42U206">pixrot</span>(<span class="mxinfo " id="T13:U160">1</span>,<span class="mxinfo " id="T17:U161">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,33" id="srcline33"> 33</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,34" id="srcline34"> 34</a></span><span class="line">        <span class="mxinfo " id="T18:U162"><span class="mxinfo " id="T18:U163"><span class="var type1" id="S2T3U212">TEMPLATE</span>(<span class="var type1" id="S18T18U213">index</span>)</span> = <span class="mxinfo " id="T15:U166">rad2deg(<span class="var type1" id="S9T15U216">an</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="104,35" id="srcline35"> 35</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,36" id="srcline36"> 36</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="104,37" id="srcline37"> 37</a></span><span class="line">    <span class="comment">%% bottom border left part</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,38" id="srcline38"> 38</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T15U219">w</span> = <span class="var type1" id="S4T15U222">W</span>:<span class="mxinfo " id="T15:U170">-1</span>:<span class="mxinfo " id="T15:U171">0</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,39" id="srcline39"> 39</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="104,40" id="srcline40"> 40</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,41" id="srcline41"> 41</a></span><span class="line">        <span class="mxinfo " id="T15:U172"><span class="var type1" id="S9T15U228">an</span> = <span class="mxinfo " id="T15:U174"><span class="mxinfo " id="T6:U175"><span class="mxinfo " id="T6:U176">pi</span>/<span class="mxinfo " id="T6:U177">2</span></span>-<span class="mxinfo " id="T15:U178">atan( <span class="mxinfo " id="T15:U179"><span class="var type1" id="S21T15U237">w</span> / <span class="var type1" id="S3T15U238">H</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,42" id="srcline42"> 42</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,43" id="srcline43"> 43</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,44" id="srcline44"> 44</a></span><span class="line">        <span class="mxinfo " id="T15:U182"><span class="var type1" id="S11T15U241">cs</span>     = <span class="mxinfo " id="T15:U184">cos(<span class="mxinfo " id="T15:U185">-<span class="var type1" id="S9T15U245">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="104,45" id="srcline45"> 45</a></span><span class="line">        <span class="mxinfo " id="T15:U187"><span class="var type1" id="S13T15U248">sn</span>     = <span class="mxinfo " id="T15:U189">sin(<span class="mxinfo " id="T15:U190">-<span class="var type1" id="S9T15U252">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,46" id="srcline46"> 46</a></span><span class="line">        <span class="mxinfo " id="T49:U192"><span class="var type1" id="S15T49U255">rot</span>    = <span class="mxinfo " id="T49:U194">[<span class="mxinfo " id="T14:U195"><span class="var type1" id="S11T15U258">cs</span> <span class="mxinfo " id="T15:U197">-<span class="var type1" id="S13T15U260">sn</span></span></span>; <span class="mxinfo " id="T14:U199"><span class="var type1" id="S13T15U262">sn</span> <span class="var type1" id="S11T15U263">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,47" id="srcline47"> 47</a></span><span class="line">        <span class="mxinfo " id="T42:U202"><span class="var type1" id="S16T42U266">pixrot</span> = <span class="mxinfo " id="T42:U204"><span class="var type1" id="S15T49U268">rot</span>*<span class="var type1" id="S6T42U269">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,48" id="srcline48"> 48</a></span><span class="line">        <span class="mxinfo " id="T16:U207"><span class="mxinfo " id="T16:U208"><span class="var type1" id="S16T42U273">pixrot</span>(<span class="mxinfo " id="T13:U210">1</span>,<span class="mxinfo " id="T17:U211">:</span>)</span> = <span class="mxinfo " id="T16:U212"><span class="mxinfo " id="T16:U213"><span class="mxinfo " id="T16:U214"><span class="var type1" id="S16T42U279">pixrot</span>(<span class="mxinfo " id="T6:U216">1</span>,<span class="mxinfo " id="T17:U217">:</span>)</span> + <span class="var type1" id="S4T15U282">W</span></span>+<span class="mxinfo " id="T6:U219">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,49" id="srcline49"> 49</a></span><span class="line">        <span class="mxinfo " id="T16:U220"><span class="mxinfo " id="T16:U221"><span class="var type1" id="S16T42U287">pixrot</span>(<span class="mxinfo " id="T13:U223">2</span>,<span class="mxinfo " id="T17:U224">:</span>)</span> = <span class="mxinfo " id="T16:U225"><span class="mxinfo " id="T16:U226"><span class="mxinfo " id="T16:U227"><span class="var type1" id="S16T42U293">pixrot</span>(<span class="mxinfo " id="T6:U229">2</span>,<span class="mxinfo " id="T17:U230">:</span>)</span> + <span class="var type1" id="S3T15U296">H</span></span>+<span class="mxinfo " id="T6:U232">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="104,50" id="srcline50"> 50</a></span><span class="line">        <span class="mxinfo " id="T42:U233"><span class="var type1" id="S16T42U300">pixrot</span>      = <span class="mxinfo " id="T42:U235"><span class="var type1" id="S16T42U302">pixrot</span>(<span class="mxinfo " id="T52:U237">:</span>, <span class="mxinfo " id="T118:U238"><span class="mxinfo " id="T118:U239"><span class="mxinfo " id="T118:U240">(<span class="mxinfo " id="T118:U241"><span class="mxinfo " id="T6:U242">1</span> &lt;= <span class="mxinfo " id="T16:U243"><span class="var type1" id="S16T42U311">pixrot</span>(<span class="mxinfo " id="T6:U245">1</span>,<span class="mxinfo " id="T17:U246">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T118:U247"><span class="mxinfo " id="T16:U248"><span class="var type1" id="S16T42U317">pixrot</span>(<span class="mxinfo " id="T6:U250">1</span>,<span class="mxinfo " id="T17:U251">:</span>)</span> &lt;= <span class="mxinfo " id="T15:U252"><span class="mxinfo " id="T15:U253">2*<span class="var type1" id="S4T15U323">W</span></span>+<span class="mxinfo " id="T6:U255">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T118:U256"><span class="mxinfo " id="T6:U257">1</span> &lt;= <span class="mxinfo " id="T16:U258"><span class="var type1" id="S16T42U329">pixrot</span>(<span class="mxinfo " id="T6:U260">2</span>,<span class="mxinfo " id="T17:U261">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T118:U262"><span class="mxinfo " id="T16:U263"><span class="var type1" id="S16T42U335">pixrot</span>(<span class="mxinfo " id="T6:U265">2</span>,<span class="mxinfo " id="T17:U266">:</span>)</span> &lt;= <span class="mxinfo " id="T15:U267"><span class="mxinfo " id="T15:U268">2*<span class="var type1" id="S3T15U341">H</span></span>+<span class="mxinfo " id="T6:U270">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,51" id="srcline51"> 51</a></span><span class="line">        <span class="mxinfo " id="T42:U271"><span class="var type1" id="S16T42U345">pixrot</span>      = <span class="mxinfo " id="T42:U273">round(<span class="var type1" id="S16T42U348">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,52" id="srcline52"> 52</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,53" id="srcline53"> 53</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,54" id="srcline54"> 54</a></span><span class="line">        <span class="mxinfo " id="T18:U275"><span class="var type1" id="S18T18U351">index</span> = <span class="mxinfo " id="T18:U277">sub2ind(<span class="mxinfo " id="T14:U278">[<span class="mxinfo " id="T15:U279"><span class="mxinfo " id="T15:U280">2*<span class="var type1" id="S3T15U359">H</span></span>+<span class="mxinfo " id="T6:U282">1</span></span>, <span class="mxinfo " id="T15:U283"><span class="mxinfo " id="T15:U284">2*<span class="var type1" id="S4T15U364">W</span></span>+<span class="mxinfo " id="T6:U286">1</span></span>]</span>, <span class="mxinfo " id="T16:U287"><span class="var type1" id="S16T42U367">pixrot</span>(<span class="mxinfo " id="T13:U289">2</span>,<span class="mxinfo " id="T17:U290">:</span>)</span>, <span class="mxinfo " id="T16:U291"><span class="var type1" id="S16T42U371">pixrot</span>(<span class="mxinfo " id="T13:U293">1</span>,<span class="mxinfo " id="T17:U294">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,55" id="srcline55"> 55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,56" id="srcline56"> 56</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo " id="T18:U295"><span class="mxinfo " id="T18:U296"><span class="var type1" id="S2T3U377">TEMPLATE</span>(<span class="var type1" id="S18T18U378">index</span>)</span> = <span class="mxinfo " id="T15:U299">rad2deg(<span class="var type1" id="S9T15U381">an</span>)</span></span>;         </span></span>
<span class="srcline"><span class="lineno"><a href="104,58" id="srcline58"> 58</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,60" id="srcline60"> 60</a></span><span class="line">    <span class="comment">%% bottom border rithg part</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,61" id="srcline61"> 61</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T15U384">w</span> = <span class="var type1" id="S4T15U387">W</span>:<span class="mxinfo " id="T15:U303">-1</span>:<span class="mxinfo " id="T15:U304">0</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,62" id="srcline62"> 62</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="104,63" id="srcline63"> 63</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,64" id="srcline64"> 64</a></span><span class="line">        <span class="mxinfo " id="T15:U305"><span class="var type1" id="S9T15U393">an</span> = <span class="mxinfo " id="T15:U307"><span class="mxinfo " id="T6:U308"><span class="mxinfo " id="T6:U309">pi</span>/<span class="mxinfo " id="T6:U310">2</span></span>+<span class="mxinfo " id="T15:U311">atan( <span class="mxinfo " id="T15:U312"><span class="var type1" id="S21T15U402">w</span> / <span class="var type1" id="S3T15U403">H</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,65" id="srcline65"> 65</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,66" id="srcline66"> 66</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,67" id="srcline67"> 67</a></span><span class="line">        <span class="mxinfo " id="T15:U315"><span class="var type1" id="S11T15U406">cs</span>     = <span class="mxinfo " id="T15:U317">cos(<span class="mxinfo " id="T15:U318">-<span class="var type1" id="S9T15U410">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="104,68" id="srcline68"> 68</a></span><span class="line">        <span class="mxinfo " id="T15:U320"><span class="var type1" id="S13T15U413">sn</span>     = <span class="mxinfo " id="T15:U322">sin(<span class="mxinfo " id="T15:U323">-<span class="var type1" id="S9T15U417">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,69" id="srcline69"> 69</a></span><span class="line">        <span class="mxinfo " id="T49:U325"><span class="var type1" id="S15T49U420">rot</span>    = <span class="mxinfo " id="T49:U327">[<span class="mxinfo " id="T14:U328"><span class="var type1" id="S11T15U423">cs</span> <span class="mxinfo " id="T15:U330">-<span class="var type1" id="S13T15U425">sn</span></span></span>; <span class="mxinfo " id="T14:U332"><span class="var type1" id="S13T15U427">sn</span> <span class="var type1" id="S11T15U428">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,70" id="srcline70"> 70</a></span><span class="line">        <span class="mxinfo " id="T42:U335"><span class="var type1" id="S16T42U431">pixrot</span> = <span class="mxinfo " id="T42:U337"><span class="var type1" id="S15T49U433">rot</span>*<span class="var type1" id="S6T42U434">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,71" id="srcline71"> 71</a></span><span class="line">        <span class="mxinfo " id="T16:U340"><span class="mxinfo " id="T16:U341"><span class="var type1" id="S16T42U438">pixrot</span>(<span class="mxinfo " id="T13:U343">1</span>,<span class="mxinfo " id="T17:U344">:</span>)</span> = <span class="mxinfo " id="T16:U345"><span class="mxinfo " id="T16:U346"><span class="mxinfo " id="T16:U347"><span class="var type1" id="S16T42U444">pixrot</span>(<span class="mxinfo " id="T6:U349">1</span>,<span class="mxinfo " id="T17:U350">:</span>)</span> + <span class="var type1" id="S4T15U447">W</span></span>+<span class="mxinfo " id="T6:U352">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,72" id="srcline72"> 72</a></span><span class="line">        <span class="mxinfo " id="T16:U353"><span class="mxinfo " id="T16:U354"><span class="var type1" id="S16T42U452">pixrot</span>(<span class="mxinfo " id="T13:U356">2</span>,<span class="mxinfo " id="T17:U357">:</span>)</span> = <span class="mxinfo " id="T16:U358"><span class="mxinfo " id="T16:U359"><span class="mxinfo " id="T16:U360"><span class="var type1" id="S16T42U458">pixrot</span>(<span class="mxinfo " id="T6:U362">2</span>,<span class="mxinfo " id="T17:U363">:</span>)</span> + <span class="var type1" id="S3T15U461">H</span></span>+<span class="mxinfo " id="T6:U365">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="104,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo " id="T42:U366"><span class="var type1" id="S16T42U465">pixrot</span>      = <span class="mxinfo " id="T42:U368"><span class="var type1" id="S16T42U467">pixrot</span>(<span class="mxinfo " id="T52:U370">:</span>, <span class="mxinfo " id="T118:U371"><span class="mxinfo " id="T118:U372"><span class="mxinfo " id="T118:U373">(<span class="mxinfo " id="T118:U374"><span class="mxinfo " id="T6:U375">1</span> &lt;= <span class="mxinfo " id="T16:U376"><span class="var type1" id="S16T42U476">pixrot</span>(<span class="mxinfo " id="T6:U378">1</span>,<span class="mxinfo " id="T17:U379">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T118:U380"><span class="mxinfo " id="T16:U381"><span class="var type1" id="S16T42U482">pixrot</span>(<span class="mxinfo " id="T6:U383">1</span>,<span class="mxinfo " id="T17:U384">:</span>)</span> &lt;= <span class="mxinfo " id="T15:U385"><span class="mxinfo " id="T15:U386">2*<span class="var type1" id="S4T15U488">W</span></span>+<span class="mxinfo " id="T6:U388">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T118:U389"><span class="mxinfo " id="T6:U390">1</span> &lt;= <span class="mxinfo " id="T16:U391"><span class="var type1" id="S16T42U494">pixrot</span>(<span class="mxinfo " id="T6:U393">2</span>,<span class="mxinfo " id="T17:U394">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T118:U395"><span class="mxinfo " id="T16:U396"><span class="var type1" id="S16T42U500">pixrot</span>(<span class="mxinfo " id="T6:U398">2</span>,<span class="mxinfo " id="T17:U399">:</span>)</span> &lt;= <span class="mxinfo " id="T15:U400"><span class="mxinfo " id="T15:U401">2*<span class="var type1" id="S3T15U506">H</span></span>+<span class="mxinfo " id="T6:U403">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,74" id="srcline74"> 74</a></span><span class="line">        <span class="mxinfo " id="T42:U404"><span class="var type1" id="S16T42U510">pixrot</span>      = <span class="mxinfo " id="T42:U406">round(<span class="var type1" id="S16T42U513">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,75" id="srcline75"> 75</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,76" id="srcline76"> 76</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,77" id="srcline77"> 77</a></span><span class="line">        <span class="mxinfo " id="T18:U408"><span class="var type1" id="S18T18U516">index</span> = <span class="mxinfo " id="T18:U410">sub2ind(<span class="mxinfo " id="T14:U411">[<span class="mxinfo " id="T15:U412"><span class="mxinfo " id="T15:U413">2*<span class="var type1" id="S3T15U524">H</span></span>+<span class="mxinfo " id="T6:U415">1</span></span>, <span class="mxinfo " id="T15:U416"><span class="mxinfo " id="T15:U417">2*<span class="var type1" id="S4T15U529">W</span></span>+<span class="mxinfo " id="T6:U419">1</span></span>]</span>, <span class="mxinfo " id="T16:U420"><span class="var type1" id="S16T42U532">pixrot</span>(<span class="mxinfo " id="T13:U422">2</span>,<span class="mxinfo " id="T17:U423">:</span>)</span>, <span class="mxinfo " id="T16:U424"><span class="var type1" id="S16T42U536">pixrot</span>(<span class="mxinfo " id="T13:U426">1</span>,<span class="mxinfo " id="T17:U427">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,79" id="srcline79"> 79</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,80" id="srcline80"> 80</a></span><span class="line">        <span class="mxinfo " id="T18:U428"><span class="mxinfo " id="T18:U429"><span class="var type1" id="S2T3U542">TEMPLATE</span>(<span class="var type1" id="S18T18U543">index</span>)</span> = <span class="mxinfo " id="T15:U432">rad2deg(<span class="var type1" id="S9T15U546">an</span>)</span></span>;         </span></span>
<span class="srcline"><span class="lineno"><a href="104,81" id="srcline81"> 81</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,82" id="srcline82"> 82</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,83" id="srcline83"> 83</a></span><span class="line">    <span class="comment">%% right border</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,84" id="srcline84"> 84</a></span><span class="line">    <span class="mxinfo " id="T42:U434"><span class="var type1" id="S6T42U549">pix</span> = <span class="mxinfo " id="T42:U436">[<span class="mxinfo " id="T16:U437"><span class="mxinfo " id="T15:U438">-2*<span class="var type1" id="S4T15U556">W</span></span>:<span class="mxinfo " id="T15:U440">2*<span class="var type1" id="S4T15U559">W</span></span></span>;<span class="mxinfo " id="T18:U442">zeros(<span class="mxinfo " id="T6:U443">1</span>,<span class="mxinfo " id="T15:U444"><span class="mxinfo " id="T15:U445">4*<span class="var type1" id="S4T15U567">W</span></span>+<span class="mxinfo " id="T6:U447">1</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,85" id="srcline85"> 85</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S8T15U571">h</span> = <span class="mxinfo " id="T15:U449"><span class="var type1" id="S3T15U574">H</span>+<span class="mxinfo " id="T6:U451">1</span></span>:<span class="mxinfo " id="T15:U452"><span class="mxinfo " id="T15:U453">2*<span class="var type1" id="S3T15U579">H</span></span>+<span class="mxinfo " id="T6:U455">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="104,86" id="srcline86"> 86</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,87" id="srcline87"> 87</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,88" id="srcline88"> 88</a></span><span class="line">        <span class="mxinfo " id="T15:U456"><span class="var type1" id="S9T15U583">an</span> = <span class="mxinfo " id="T15:U458"><span class="mxinfo " id="T6:U459">pi</span>-<span class="mxinfo " id="T15:U460">atan( <span class="mxinfo " id="T15:U461">(<span class="mxinfo " id="T15:U462"><span class="var type1" id="S8T15U592">h</span>-(<span class="mxinfo " id="T15:U464"><span class="var type1" id="S3T15U595">H</span>+<span class="mxinfo " id="T6:U466">1</span></span>)</span>) / <span class="var type1" id="S4T15U597">W</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,89" id="srcline89"> 89</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="104,90" id="srcline90"> 90</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,91" id="srcline91"> 91</a></span><span class="line">        <span class="mxinfo " id="T15:U468"><span class="var type1" id="S11T15U600">cs</span>     = <span class="mxinfo " id="T15:U470">cos(<span class="mxinfo " id="T15:U471">-<span class="var type1" id="S9T15U604">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="104,92" id="srcline92"> 92</a></span><span class="line">        <span class="mxinfo " id="T15:U473"><span class="var type1" id="S13T15U607">sn</span>     = <span class="mxinfo " id="T15:U475">sin(<span class="mxinfo " id="T15:U476">-<span class="var type1" id="S9T15U611">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,93" id="srcline93"> 93</a></span><span class="line">        <span class="mxinfo " id="T49:U478"><span class="var type1" id="S15T49U614">rot</span>    = <span class="mxinfo " id="T49:U480">[<span class="mxinfo " id="T14:U481"><span class="var type1" id="S11T15U617">cs</span> <span class="mxinfo " id="T15:U483">-<span class="var type1" id="S13T15U619">sn</span></span></span>; <span class="mxinfo " id="T14:U485"><span class="var type1" id="S13T15U621">sn</span> <span class="var type1" id="S11T15U622">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,94" id="srcline94"> 94</a></span><span class="line">        <span class="mxinfo " id="T42:U488"><span class="var type1" id="S16T42U625">pixrot</span> = <span class="mxinfo " id="T42:U490"><span class="var type1" id="S15T49U627">rot</span>*<span class="var type1" id="S6T42U628">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,95" id="srcline95"> 95</a></span><span class="line">        <span class="mxinfo " id="T16:U493"><span class="mxinfo " id="T16:U494"><span class="var type1" id="S16T42U632">pixrot</span>(<span class="mxinfo " id="T13:U496">1</span>,<span class="mxinfo " id="T17:U497">:</span>)</span> = <span class="mxinfo " id="T16:U498"><span class="mxinfo " id="T16:U499"><span class="mxinfo " id="T16:U500"><span class="var type1" id="S16T42U638">pixrot</span>(<span class="mxinfo " id="T6:U502">1</span>,<span class="mxinfo " id="T17:U503">:</span>)</span> + <span class="var type1" id="S4T15U641">W</span></span>+<span class="mxinfo " id="T6:U505">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,96" id="srcline96"> 96</a></span><span class="line">        <span class="mxinfo " id="T16:U506"><span class="mxinfo " id="T16:U507"><span class="var type1" id="S16T42U646">pixrot</span>(<span class="mxinfo " id="T13:U509">2</span>,<span class="mxinfo " id="T17:U510">:</span>)</span> = <span class="mxinfo " id="T16:U511"><span class="mxinfo " id="T16:U512"><span class="mxinfo " id="T16:U513"><span class="var type1" id="S16T42U652">pixrot</span>(<span class="mxinfo " id="T6:U515">2</span>,<span class="mxinfo " id="T17:U516">:</span>)</span> + <span class="var type1" id="S3T15U655">H</span></span>+<span class="mxinfo " id="T6:U518">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="104,97" id="srcline97"> 97</a></span><span class="line">        <span class="mxinfo " id="T42:U519"><span class="var type1" id="S16T42U659">pixrot</span>      = <span class="mxinfo " id="T42:U521"><span class="var type1" id="S16T42U661">pixrot</span>(<span class="mxinfo " id="T52:U523">:</span>, <span class="mxinfo " id="T118:U524"><span class="mxinfo " id="T118:U525"><span class="mxinfo " id="T118:U526">(<span class="mxinfo " id="T118:U527"><span class="mxinfo " id="T6:U528">1</span> &lt;= <span class="mxinfo " id="T16:U529"><span class="var type1" id="S16T42U670">pixrot</span>(<span class="mxinfo " id="T6:U531">1</span>,<span class="mxinfo " id="T17:U532">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T118:U533"><span class="mxinfo " id="T16:U534"><span class="var type1" id="S16T42U676">pixrot</span>(<span class="mxinfo " id="T6:U536">1</span>,<span class="mxinfo " id="T17:U537">:</span>)</span> &lt;= <span class="mxinfo " id="T15:U538"><span class="mxinfo " id="T15:U539">2*<span class="var type1" id="S4T15U682">W</span></span>+<span class="mxinfo " id="T6:U541">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T118:U542"><span class="mxinfo " id="T6:U543">1</span> &lt;= <span class="mxinfo " id="T16:U544"><span class="var type1" id="S16T42U688">pixrot</span>(<span class="mxinfo " id="T6:U546">2</span>,<span class="mxinfo " id="T17:U547">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T118:U548"><span class="mxinfo " id="T16:U549"><span class="var type1" id="S16T42U694">pixrot</span>(<span class="mxinfo " id="T6:U551">2</span>,<span class="mxinfo " id="T17:U552">:</span>)</span> &lt;= <span class="mxinfo " id="T15:U553"><span class="mxinfo " id="T15:U554">2*<span class="var type1" id="S3T15U700">H</span></span>+<span class="mxinfo " id="T6:U556">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,98" id="srcline98"> 98</a></span><span class="line">        <span class="mxinfo " id="T42:U557"><span class="var type1" id="S16T42U704">pixrot</span>      = <span class="mxinfo " id="T42:U559">round(<span class="var type1" id="S16T42U707">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,99" id="srcline99"> 99</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,100" id="srcline100">100</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,101" id="srcline101">101</a></span><span class="line">        <span class="mxinfo " id="T18:U561"><span class="var type1" id="S18T18U710">index</span> = <span class="mxinfo " id="T18:U563">sub2ind(<span class="mxinfo " id="T14:U564">[<span class="mxinfo " id="T15:U565"><span class="mxinfo " id="T15:U566">2*<span class="var type1" id="S3T15U718">H</span></span>+<span class="mxinfo " id="T6:U568">1</span></span>, <span class="mxinfo " id="T15:U569"><span class="mxinfo " id="T15:U570">2*<span class="var type1" id="S4T15U723">W</span></span>+<span class="mxinfo " id="T6:U572">1</span></span>]</span>, <span class="mxinfo " id="T16:U573"><span class="var type1" id="S16T42U726">pixrot</span>(<span class="mxinfo " id="T13:U575">2</span>,<span class="mxinfo " id="T17:U576">:</span>)</span>, <span class="mxinfo " id="T16:U577"><span class="var type1" id="S16T42U730">pixrot</span>(<span class="mxinfo " id="T13:U579">1</span>,<span class="mxinfo " id="T17:U580">:</span>)</span> )</span></span>;     </span></span>
<span class="srcline"><span class="lineno"><a href="104,102" id="srcline102">102</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,103" id="srcline103">103</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,104" id="srcline104">104</a></span><span class="line">        <span class="mxinfo " id="T18:U581"><span class="mxinfo " id="T18:U582"><span class="var type1" id="S2T3U736">TEMPLATE</span>(<span class="var type1" id="S18T18U737">index</span>)</span> = <span class="mxinfo " id="T15:U585">rad2deg(<span class="var type1" id="S9T15U740">an</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="104,105" id="srcline105">105</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,106" id="srcline106">106</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="104,107" id="srcline107">107</a></span><span class="line">    <span class="comment">%% fill in holes</span></span></span>
<span class="srcline"><span class="lineno"><a href="104,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T3:U587"><span class="var type1" id="S2T3U743">TEMPLATE</span> = <span class="mxinfo " id="T3:U589">imdilate( <span class="var type1" id="S2T3U746">TEMPLATE</span>, ones(<span class="mxinfo " id="T6:U591">3</span>,<span class="mxinfo " id="T6:U592">3</span>) )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="104,109" id="srcline109">109</a></span><span class="line">    <span class="mxinfo " id="T3:U593"><span class="mxinfo " id="T3:U594"><span class="var type1" id="S2T3U754">TEMPLATE</span>(<span class="mxinfo " id="T16:U596"><span class="mxinfo " id="T15:U597">1</span>:<span class="mxinfo " id="T15:U598"><span class="var type1" id="S3T15U758">H</span>+<span class="mxinfo " id="T6:U600">2</span></span></span>,<span class="mxinfo " id="T17:U601">:</span>)</span> = <span class="mxinfo " id="T6:U602">-<span class="mxinfo " id="T6:U603">180</span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="104,110" id="srcline110">110</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="104,111" id="srcline111">111</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
