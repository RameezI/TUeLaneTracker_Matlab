<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%% create edge template%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T2U3">TEMPLATE</span>] = createTemplate( <span class="var type1" id="S3T1U6">H</span> ,<span class="var type1" id="S4T1U7">W</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line">    <span class="comment">%% empty template</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line">    <span class="mxinfo  sgl" id="T2:U4"><span class="var type1" id="S2T2U10">TEMPLATE</span> = <span class="mxinfo  sgl" id="T2:U6">-180 * <span class="mxinfo  sgl" id="T2:U7">ones( <span class="mxinfo  sgl" id="T1:U8"><span class="mxinfo  sgl" id="T1:U9">2*<span class="var type1 sgl" id="S3T1U19">H</span></span>+1</span>, <span class="mxinfo  sgl" id="T1:U11"><span class="mxinfo  sgl" id="T1:U12">2*<span class="var type1 sgl" id="S4T1U24">W</span></span>+1</span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line">    <span class="mxinfo  sgl" id="T3:U14"><span class="var type1" id="S6T3U28">pix</span>      = <span class="mxinfo  sgl" id="T3:U16">[<span class="mxinfo  dbl sgl" id="T4:U17"><span class="message warning" id="M1F1C"><span class="mxinfo  sgl" id="T1:U18">-2*<span class="var type1 sgl" id="S4T1U35">W</span></span>:<span class="mxinfo  sgl" id="T1:U20">2*<span class="var type1 sgl" id="S4T1U38">W</span></span></span></span>;<span class="mxinfo  sgl" id="T4:U22">zeros(1,<span class="mxinfo  sgl" id="T1:U23"><span class="mxinfo  sgl" id="T1:U24">4*<span class="var type1 sgl" id="S4T1U46">W</span></span>+1</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line">    <span class="comment">%% left border</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S8T1U50">h</span> = <span class="mxinfo  sgl" id="T1:U27"><span class="mxinfo  sgl" id="T1:U28"><span class="var type1 sgl" id="S3T1U53">H</span>+1</span>:<span class="mxinfo  sgl" id="T1:U30"><span class="mxinfo  sgl" id="T1:U31">2*<span class="var type1 sgl" id="S3T1U58">H</span></span>+1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">        <span class="mxinfo " id="T1:U33"><span class="var type1" id="S9T1U62">an</span> = <span class="mxinfo  sgl" id="T1:U35">atan( <span class="mxinfo  sgl" id="T1:U36">(<span class="mxinfo  sgl" id="T1:U37"><span class="var type1" id="S8T1U68">h</span>-(<span class="mxinfo  sgl" id="T1:U39"><span class="var type1 sgl" id="S3T1U71">H</span>+1</span>)</span>) / <span class="var type1 sgl" id="S4T1U73">W</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">        <span class="mxinfo " id="T1:U42"><span class="var type1" id="S11T1U76">cs</span>     = <span class="mxinfo  sgl" id="T1:U44">cos(<span class="mxinfo  sgl" id="T1:U45">-<span class="var type1" id="S9T1U80">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">        <span class="mxinfo " id="T1:U47"><span class="var type1" id="S13T1U83">sn</span>     = <span class="mxinfo  sgl" id="T1:U49">sin(<span class="mxinfo  sgl" id="T1:U50">-<span class="var type1" id="S9T1U87">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">        <span class="mxinfo  sgl" id="T5:U52"><span class="var type1 sgl" id="S15T5U90">rot</span>    = <span class="mxinfo " id="T5:U54">[<span class="mxinfo " id="T6:U55"><span class="var type1" id="S11T1U93">cs</span> <span class="mxinfo  sgl" id="T1:U57">-<span class="var type1" id="S13T1U95">sn</span></span></span>; <span class="mxinfo " id="T6:U59"><span class="var type1" id="S13T1U97">sn</span> <span class="var type1" id="S11T1U98">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U62"><span class="var type1" id="S16T3U101">pixrot</span> = <span class="mxinfo  sgl" id="T3:U64"><span class="var type1 sgl" id="S15T5U103">rot</span>*<span class="var type1 sgl" id="S6T3U104">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U67"><span class="mxinfo  sgl" id="T4:U68"><span class="var type1 sgl" id="S16T3U108">pixrot</span>(<span class="mxinfo " id="T7:U70">1</span>,<span class="mxinfo " id="T8:U71">:</span>)</span> = <span class="mxinfo  sgl" id="T4:U72"><span class="mxinfo  sgl" id="T4:U73"><span class="mxinfo " id="T4:U74"><span class="var type1 sgl" id="S16T3U114">pixrot</span>(<span class="mxinfo " id="T7:U76">1</span>,<span class="mxinfo  sgl" id="T8:U77">:</span>)</span> + <span class="var type1 sgl" id="S4T1U117">W</span></span>+1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U79"><span class="mxinfo  sgl" id="T4:U80"><span class="var type1 sgl" id="S16T3U122">pixrot</span>(<span class="mxinfo " id="T7:U82">2</span>,<span class="mxinfo " id="T8:U83">:</span>)</span> = <span class="mxinfo  sgl" id="T4:U84"><span class="mxinfo  sgl" id="T4:U85"><span class="mxinfo " id="T4:U86"><span class="var type1 sgl" id="S16T3U128">pixrot</span>(<span class="mxinfo " id="T7:U88">2</span>,<span class="mxinfo  sgl" id="T8:U89">:</span>)</span> + <span class="var type1 sgl" id="S3T1U131">H</span></span>+1</span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U91"><span class="var type1 sgl" id="S16T3U135">pixrot</span>      = <span class="mxinfo  sgl" id="T3:U93"><span class="var type1 sgl" id="S16T3U137">pixrot</span>(<span class="mxinfo " id="T9:U95">:</span>, <span class="mxinfo " id="T10:U96"><span class="mxinfo  sgl" id="T10:U97"><span class="mxinfo " id="T10:U98">(<span class="mxinfo " id="T10:U99"><span class="mxinfo  sgl" id="T1:U100">1</span> &lt;= <span class="mxinfo " id="T4:U101"><span class="var type1 sgl" id="S16T3U146">pixrot</span>(<span class="mxinfo " id="T7:U103">1</span>,<span class="mxinfo  sgl" id="T8:U104">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T10:U105"><span class="mxinfo " id="T4:U106"><span class="var type1 sgl" id="S16T3U152">pixrot</span>(<span class="mxinfo " id="T1:U108">1</span>,<span class="mxinfo " id="T8:U109">:</span>)</span> &lt;= <span class="mxinfo  sgl" id="T1:U110"><span class="mxinfo  sgl" id="T1:U111">2*<span class="var type1 sgl" id="S4T1U158">W</span></span>+1</span></span>)</span> &amp; (<span class="mxinfo " id="T10:U113"><span class="mxinfo  sgl" id="T1:U114">1</span> &lt;= <span class="mxinfo " id="T4:U115"><span class="var type1 sgl" id="S16T3U164">pixrot</span>(<span class="mxinfo " id="T1:U117">2</span>,<span class="mxinfo " id="T8:U118">:</span>)</span></span>)</span> &amp; (<span class="mxinfo  sgl" id="T10:U119"><span class="mxinfo " id="T4:U120"><span class="var type1 sgl" id="S16T3U170">pixrot</span>(<span class="mxinfo " id="T1:U122">2</span>,<span class="mxinfo  sgl" id="T8:U123">:</span>)</span> &lt;= <span class="mxinfo  sgl" id="T1:U124"><span class="mxinfo  sgl" id="T1:U125">2*<span class="var type1 sgl" id="S3T1U176">H</span></span>+1</span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">        <span class="mxinfo " id="T3:U127"><span class="var type1" id="S16T3U180">pixrot</span>      = <span class="mxinfo  sgl" id="T3:U129">round(<span class="var type1 sgl" id="S16T3U183">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">        <span class="mxinfo " id="T4:U131"><span class="var type1" id="S18T4U186">index</span> = <span class="mxinfo  sgl" id="T4:U133"><span class="message warning" id="M2F1C">sub2ind(<span class="mxinfo " id="T6:U134">[<span class="mxinfo  sgl" id="T1:U135"><span class="mxinfo  sgl" id="T1:U136">2*<span class="var type1 sgl" id="S3T1U194">H</span></span>+1</span>, <span class="mxinfo " id="T1:U138"><span class="mxinfo " id="T1:U139">2*<span class="var type1" id="S4T1U199">W</span></span>+1</span>]</span>, <span class="mxinfo  sgl" id="T4:U141"><span class="var type1" id="S16T3U202">pixrot</span>(<span class="mxinfo " id="T7:U143">2</span>,<span class="mxinfo  sgl" id="T8:U144">:</span>)</span>, <span class="mxinfo  sgl" id="T4:U145"><span class="var type1" id="S16T3U206">pixrot</span>(<span class="mxinfo " id="T7:U147">1</span>,<span class="mxinfo  sgl" id="T8:U148">:</span>)</span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U149"><span class="mxinfo  sgl" id="T4:U150"><span class="var type1 sgl" id="S2T2U212">TEMPLATE</span>(<span class="var type1" id="S18T4U213">index</span>)</span> = <span class="mxinfo  sgl" id="T1:U153">rad2deg(<span class="var type1" id="S9T1U216">an</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="comment">%% bottom border left part</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T1U219">w</span> = <span class="mxinfo  sgl" id="T1:U156"><span class="var type1 sgl" id="S4T1U222">W</span>:<span class="mxinfo  sgl" id="T1:U158">-1</span>:<span class="mxinfo " id="T1:U159">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">        <span class="mxinfo " id="T1:U160"><span class="var type1" id="S9T1U228">an</span> = <span class="mxinfo  sgl" id="T1:U162">pi/2-<span class="mxinfo  sgl" id="T1:U163">atan( <span class="mxinfo  sgl" id="T1:U164"><span class="var type1" id="S21T1U237">w</span> / <span class="var type1 sgl" id="S3T1U238">H</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">        <span class="mxinfo " id="T1:U167"><span class="var type1" id="S11T1U241">cs</span>     = <span class="mxinfo  sgl" id="T1:U169">cos(<span class="mxinfo  sgl" id="T1:U170">-<span class="var type1" id="S9T1U245">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">        <span class="mxinfo " id="T1:U172"><span class="var type1" id="S13T1U248">sn</span>     = <span class="mxinfo  sgl" id="T1:U174">sin(<span class="mxinfo  sgl" id="T1:U175">-<span class="var type1" id="S9T1U252">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">        <span class="mxinfo  sgl" id="T5:U177"><span class="var type1 sgl" id="S15T5U255">rot</span>    = <span class="mxinfo " id="T5:U179">[<span class="mxinfo " id="T6:U180"><span class="var type1" id="S11T1U258">cs</span> <span class="mxinfo  sgl" id="T1:U182">-<span class="var type1" id="S13T1U260">sn</span></span></span>; <span class="mxinfo " id="T6:U184"><span class="var type1" id="S13T1U262">sn</span> <span class="var type1" id="S11T1U263">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U187"><span class="var type1" id="S16T3U266">pixrot</span> = <span class="mxinfo  sgl" id="T3:U189"><span class="var type1 sgl" id="S15T5U268">rot</span>*<span class="var type1 sgl" id="S6T3U269">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U192"><span class="mxinfo  sgl" id="T4:U193"><span class="var type1 sgl" id="S16T3U273">pixrot</span>(<span class="mxinfo " id="T7:U195">1</span>,<span class="mxinfo " id="T8:U196">:</span>)</span> = <span class="mxinfo  sgl" id="T4:U197"><span class="mxinfo  sgl" id="T4:U198"><span class="mxinfo " id="T4:U199"><span class="var type1 sgl" id="S16T3U279">pixrot</span>(<span class="mxinfo " id="T7:U201">1</span>,<span class="mxinfo  sgl" id="T8:U202">:</span>)</span> + <span class="var type1 sgl" id="S4T1U282">W</span></span>+1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U204"><span class="mxinfo  sgl" id="T4:U205"><span class="var type1 sgl" id="S16T3U287">pixrot</span>(<span class="mxinfo " id="T7:U207">2</span>,<span class="mxinfo " id="T8:U208">:</span>)</span> = <span class="mxinfo  sgl" id="T4:U209"><span class="mxinfo  sgl" id="T4:U210"><span class="mxinfo " id="T4:U211"><span class="var type1 sgl" id="S16T3U293">pixrot</span>(<span class="mxinfo " id="T7:U213">2</span>,<span class="mxinfo  sgl" id="T8:U214">:</span>)</span> + <span class="var type1 sgl" id="S3T1U296">H</span></span>+1</span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U216"><span class="var type1 sgl" id="S16T3U300">pixrot</span>      = <span class="mxinfo  sgl" id="T3:U218"><span class="var type1 sgl" id="S16T3U302">pixrot</span>(<span class="mxinfo " id="T9:U220">:</span>, <span class="mxinfo " id="T10:U221"><span class="mxinfo  sgl" id="T10:U222"><span class="mxinfo " id="T10:U223">(<span class="mxinfo " id="T10:U224"><span class="mxinfo  sgl" id="T1:U225">1</span> &lt;= <span class="mxinfo " id="T4:U226"><span class="var type1 sgl" id="S16T3U311">pixrot</span>(<span class="mxinfo " id="T7:U228">1</span>,<span class="mxinfo  sgl" id="T8:U229">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T10:U230"><span class="mxinfo " id="T4:U231"><span class="var type1 sgl" id="S16T3U317">pixrot</span>(<span class="mxinfo " id="T1:U233">1</span>,<span class="mxinfo " id="T8:U234">:</span>)</span> &lt;= <span class="mxinfo  sgl" id="T1:U235"><span class="mxinfo  sgl" id="T1:U236">2*<span class="var type1 sgl" id="S4T1U323">W</span></span>+1</span></span>)</span> &amp; (<span class="mxinfo " id="T10:U238"><span class="mxinfo  sgl" id="T1:U239">1</span> &lt;= <span class="mxinfo " id="T4:U240"><span class="var type1 sgl" id="S16T3U329">pixrot</span>(<span class="mxinfo " id="T1:U242">2</span>,<span class="mxinfo " id="T8:U243">:</span>)</span></span>)</span> &amp; (<span class="mxinfo  sgl" id="T10:U244"><span class="mxinfo " id="T4:U245"><span class="var type1 sgl" id="S16T3U335">pixrot</span>(<span class="mxinfo " id="T1:U247">2</span>,<span class="mxinfo  sgl" id="T8:U248">:</span>)</span> &lt;= <span class="mxinfo  sgl" id="T1:U249"><span class="mxinfo  sgl" id="T1:U250">2*<span class="var type1 sgl" id="S3T1U341">H</span></span>+1</span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">        <span class="mxinfo " id="T3:U252"><span class="var type1" id="S16T3U345">pixrot</span>      = <span class="mxinfo  sgl" id="T3:U254">round(<span class="var type1 sgl" id="S16T3U348">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">        <span class="mxinfo " id="T4:U256"><span class="var type1" id="S18T4U351">index</span> = <span class="mxinfo  sgl" id="T4:U258"><span class="message warning" id="M3F1C">sub2ind(<span class="mxinfo " id="T6:U259">[<span class="mxinfo  sgl" id="T1:U260"><span class="mxinfo  sgl" id="T1:U261">2*<span class="var type1 sgl" id="S3T1U359">H</span></span>+1</span>, <span class="mxinfo " id="T1:U263"><span class="mxinfo " id="T1:U264">2*<span class="var type1" id="S4T1U364">W</span></span>+1</span>]</span>, <span class="mxinfo  sgl" id="T4:U266"><span class="var type1" id="S16T3U367">pixrot</span>(<span class="mxinfo " id="T7:U268">2</span>,<span class="mxinfo  sgl" id="T8:U269">:</span>)</span>, <span class="mxinfo  sgl" id="T4:U270"><span class="var type1" id="S16T3U371">pixrot</span>(<span class="mxinfo " id="T7:U272">1</span>,<span class="mxinfo  sgl" id="T8:U273">:</span>)</span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U274"><span class="mxinfo  sgl" id="T4:U275"><span class="var type1 sgl" id="S2T2U377">TEMPLATE</span>(<span class="var type1" id="S18T4U378">index</span>)</span> = <span class="mxinfo  sgl" id="T1:U278">rad2deg(<span class="var type1" id="S9T1U381">an</span>)</span></span>;         </span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="comment">%% bottom border rithg part</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T1U384">w</span> = <span class="mxinfo  sgl" id="T1:U281"><span class="var type1 sgl" id="S4T1U387">W</span>:<span class="mxinfo  sgl" id="T1:U283">-1</span>:<span class="mxinfo " id="T1:U284">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">        <span class="mxinfo " id="T1:U285"><span class="var type1" id="S9T1U393">an</span> = <span class="mxinfo  sgl" id="T1:U287">pi/2+<span class="mxinfo  sgl" id="T1:U288">atan( <span class="mxinfo  sgl" id="T1:U289"><span class="var type1" id="S21T1U402">w</span> / <span class="var type1 sgl" id="S3T1U403">H</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">        <span class="mxinfo " id="T1:U292"><span class="var type1" id="S11T1U406">cs</span>     = <span class="mxinfo  sgl" id="T1:U294">cos(<span class="mxinfo  sgl" id="T1:U295">-<span class="var type1" id="S9T1U410">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">        <span class="mxinfo " id="T1:U297"><span class="var type1" id="S13T1U413">sn</span>     = <span class="mxinfo  sgl" id="T1:U299">sin(<span class="mxinfo  sgl" id="T1:U300">-<span class="var type1" id="S9T1U417">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">        <span class="mxinfo  sgl" id="T5:U302"><span class="var type1 sgl" id="S15T5U420">rot</span>    = <span class="mxinfo " id="T5:U304">[<span class="mxinfo " id="T6:U305"><span class="var type1" id="S11T1U423">cs</span> <span class="mxinfo  sgl" id="T1:U307">-<span class="var type1" id="S13T1U425">sn</span></span></span>; <span class="mxinfo " id="T6:U309"><span class="var type1" id="S13T1U427">sn</span> <span class="var type1" id="S11T1U428">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U312"><span class="var type1" id="S16T3U431">pixrot</span> = <span class="mxinfo  sgl" id="T3:U314"><span class="var type1 sgl" id="S15T5U433">rot</span>*<span class="var type1 sgl" id="S6T3U434">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U317"><span class="mxinfo  sgl" id="T4:U318"><span class="var type1 sgl" id="S16T3U438">pixrot</span>(<span class="mxinfo " id="T7:U320">1</span>,<span class="mxinfo " id="T8:U321">:</span>)</span> = <span class="mxinfo  sgl" id="T4:U322"><span class="mxinfo  sgl" id="T4:U323"><span class="mxinfo " id="T4:U324"><span class="var type1 sgl" id="S16T3U444">pixrot</span>(<span class="mxinfo " id="T7:U326">1</span>,<span class="mxinfo  sgl" id="T8:U327">:</span>)</span> + <span class="var type1 sgl" id="S4T1U447">W</span></span>+1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U329"><span class="mxinfo  sgl" id="T4:U330"><span class="var type1 sgl" id="S16T3U452">pixrot</span>(<span class="mxinfo " id="T7:U332">2</span>,<span class="mxinfo " id="T8:U333">:</span>)</span> = <span class="mxinfo  sgl" id="T4:U334"><span class="mxinfo  sgl" id="T4:U335"><span class="mxinfo " id="T4:U336"><span class="var type1 sgl" id="S16T3U458">pixrot</span>(<span class="mxinfo " id="T7:U338">2</span>,<span class="mxinfo  sgl" id="T8:U339">:</span>)</span> + <span class="var type1 sgl" id="S3T1U461">H</span></span>+1</span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U341"><span class="var type1 sgl" id="S16T3U465">pixrot</span>      = <span class="mxinfo  sgl" id="T3:U343"><span class="var type1 sgl" id="S16T3U467">pixrot</span>(<span class="mxinfo " id="T9:U345">:</span>, <span class="mxinfo " id="T10:U346"><span class="mxinfo  sgl" id="T10:U347"><span class="mxinfo " id="T10:U348">(<span class="mxinfo " id="T10:U349"><span class="mxinfo  sgl" id="T1:U350">1</span> &lt;= <span class="mxinfo " id="T4:U351"><span class="var type1 sgl" id="S16T3U476">pixrot</span>(<span class="mxinfo " id="T7:U353">1</span>,<span class="mxinfo  sgl" id="T8:U354">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T10:U355"><span class="mxinfo " id="T4:U356"><span class="var type1 sgl" id="S16T3U482">pixrot</span>(<span class="mxinfo " id="T1:U358">1</span>,<span class="mxinfo " id="T8:U359">:</span>)</span> &lt;= <span class="mxinfo  sgl" id="T1:U360"><span class="mxinfo  sgl" id="T1:U361">2*<span class="var type1 sgl" id="S4T1U488">W</span></span>+1</span></span>)</span> &amp; (<span class="mxinfo " id="T10:U363"><span class="mxinfo  sgl" id="T1:U364">1</span> &lt;= <span class="mxinfo " id="T4:U365"><span class="var type1 sgl" id="S16T3U494">pixrot</span>(<span class="mxinfo " id="T1:U367">2</span>,<span class="mxinfo " id="T8:U368">:</span>)</span></span>)</span> &amp; (<span class="mxinfo  sgl" id="T10:U369"><span class="mxinfo " id="T4:U370"><span class="var type1 sgl" id="S16T3U500">pixrot</span>(<span class="mxinfo " id="T1:U372">2</span>,<span class="mxinfo  sgl" id="T8:U373">:</span>)</span> &lt;= <span class="mxinfo  sgl" id="T1:U374"><span class="mxinfo  sgl" id="T1:U375">2*<span class="var type1 sgl" id="S3T1U506">H</span></span>+1</span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">        <span class="mxinfo " id="T3:U377"><span class="var type1" id="S16T3U510">pixrot</span>      = <span class="mxinfo  sgl" id="T3:U379">round(<span class="var type1 sgl" id="S16T3U513">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo " id="T4:U381"><span class="var type1" id="S18T4U516">index</span> = <span class="mxinfo  sgl" id="T4:U383"><span class="message warning" id="M4F1C">sub2ind(<span class="mxinfo " id="T6:U384">[<span class="mxinfo  sgl" id="T1:U385"><span class="mxinfo  sgl" id="T1:U386">2*<span class="var type1 sgl" id="S3T1U524">H</span></span>+1</span>, <span class="mxinfo " id="T1:U388"><span class="mxinfo " id="T1:U389">2*<span class="var type1" id="S4T1U529">W</span></span>+1</span>]</span>, <span class="mxinfo  sgl" id="T4:U391"><span class="var type1" id="S16T3U532">pixrot</span>(<span class="mxinfo " id="T7:U393">2</span>,<span class="mxinfo  sgl" id="T8:U394">:</span>)</span>, <span class="mxinfo  sgl" id="T4:U395"><span class="var type1" id="S16T3U536">pixrot</span>(<span class="mxinfo " id="T7:U397">1</span>,<span class="mxinfo  sgl" id="T8:U398">:</span>)</span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U399"><span class="mxinfo  sgl" id="T4:U400"><span class="var type1 sgl" id="S2T2U542">TEMPLATE</span>(<span class="var type1" id="S18T4U543">index</span>)</span> = <span class="mxinfo  sgl" id="T1:U403">rad2deg(<span class="var type1" id="S9T1U546">an</span>)</span></span>;         </span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">    <span class="comment">%% right border</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">    <span class="mxinfo  sgl" id="T3:U405"><span class="var type1" id="S6T3U549">pix</span> = <span class="mxinfo  sgl" id="T3:U407">[<span class="mxinfo  dbl sgl" id="T4:U408"><span class="message warning" id="M5F1C"><span class="mxinfo  sgl" id="T1:U409">-2*<span class="var type1 sgl" id="S4T1U556">W</span></span>:<span class="mxinfo  sgl" id="T1:U411">2*<span class="var type1 sgl" id="S4T1U559">W</span></span></span></span>;<span class="mxinfo  sgl" id="T4:U413">zeros(1,<span class="mxinfo  sgl" id="T1:U414"><span class="mxinfo  sgl" id="T1:U415">4*<span class="var type1 sgl" id="S4T1U567">W</span></span>+1</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S8T1U571">h</span> = <span class="mxinfo  sgl" id="T1:U418"><span class="mxinfo  sgl" id="T1:U419"><span class="var type1 sgl" id="S3T1U574">H</span>+1</span>:<span class="mxinfo  sgl" id="T1:U421"><span class="mxinfo  sgl" id="T1:U422">2*<span class="var type1 sgl" id="S3T1U579">H</span></span>+1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">        <span class="mxinfo " id="T1:U424"><span class="var type1" id="S9T1U583">an</span> = <span class="mxinfo  sgl" id="T1:U426">pi-<span class="mxinfo  sgl" id="T1:U427">atan( <span class="mxinfo  sgl" id="T1:U428">(<span class="mxinfo  sgl" id="T1:U429"><span class="var type1" id="S8T1U592">h</span>-(<span class="mxinfo  sgl" id="T1:U431"><span class="var type1 sgl" id="S3T1U595">H</span>+1</span>)</span>) / <span class="var type1 sgl" id="S4T1U597">W</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">        <span class="mxinfo " id="T1:U434"><span class="var type1" id="S11T1U600">cs</span>     = <span class="mxinfo  sgl" id="T1:U436">cos(<span class="mxinfo  sgl" id="T1:U437">-<span class="var type1" id="S9T1U604">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">        <span class="mxinfo " id="T1:U439"><span class="var type1" id="S13T1U607">sn</span>     = <span class="mxinfo  sgl" id="T1:U441">sin(<span class="mxinfo  sgl" id="T1:U442">-<span class="var type1" id="S9T1U611">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">        <span class="mxinfo  sgl" id="T5:U444"><span class="var type1 sgl" id="S15T5U614">rot</span>    = <span class="mxinfo " id="T5:U446">[<span class="mxinfo " id="T6:U447"><span class="var type1" id="S11T1U617">cs</span> <span class="mxinfo  sgl" id="T1:U449">-<span class="var type1" id="S13T1U619">sn</span></span></span>; <span class="mxinfo " id="T6:U451"><span class="var type1" id="S13T1U621">sn</span> <span class="var type1" id="S11T1U622">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U454"><span class="var type1" id="S16T3U625">pixrot</span> = <span class="mxinfo  sgl" id="T3:U456"><span class="var type1 sgl" id="S15T5U627">rot</span>*<span class="var type1 sgl" id="S6T3U628">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U459"><span class="mxinfo  sgl" id="T4:U460"><span class="var type1 sgl" id="S16T3U632">pixrot</span>(<span class="mxinfo " id="T7:U462">1</span>,<span class="mxinfo " id="T8:U463">:</span>)</span> = <span class="mxinfo  sgl" id="T4:U464"><span class="mxinfo  sgl" id="T4:U465"><span class="mxinfo " id="T4:U466"><span class="var type1 sgl" id="S16T3U638">pixrot</span>(<span class="mxinfo " id="T7:U468">1</span>,<span class="mxinfo  sgl" id="T8:U469">:</span>)</span> + <span class="var type1 sgl" id="S4T1U641">W</span></span>+1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U471"><span class="mxinfo  sgl" id="T4:U472"><span class="var type1 sgl" id="S16T3U646">pixrot</span>(<span class="mxinfo " id="T7:U474">2</span>,<span class="mxinfo " id="T8:U475">:</span>)</span> = <span class="mxinfo  sgl" id="T4:U476"><span class="mxinfo  sgl" id="T4:U477"><span class="mxinfo " id="T4:U478"><span class="var type1 sgl" id="S16T3U652">pixrot</span>(<span class="mxinfo " id="T7:U480">2</span>,<span class="mxinfo  sgl" id="T8:U481">:</span>)</span> + <span class="var type1 sgl" id="S3T1U655">H</span></span>+1</span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U483"><span class="var type1 sgl" id="S16T3U659">pixrot</span>      = <span class="mxinfo  sgl" id="T3:U485"><span class="var type1 sgl" id="S16T3U661">pixrot</span>(<span class="mxinfo " id="T9:U487">:</span>, <span class="mxinfo " id="T10:U488"><span class="mxinfo  sgl" id="T10:U489"><span class="mxinfo " id="T10:U490">(<span class="mxinfo " id="T10:U491"><span class="mxinfo  sgl" id="T1:U492">1</span> &lt;= <span class="mxinfo " id="T4:U493"><span class="var type1 sgl" id="S16T3U670">pixrot</span>(<span class="mxinfo " id="T7:U495">1</span>,<span class="mxinfo  sgl" id="T8:U496">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T10:U497"><span class="mxinfo " id="T4:U498"><span class="var type1 sgl" id="S16T3U676">pixrot</span>(<span class="mxinfo " id="T1:U500">1</span>,<span class="mxinfo " id="T8:U501">:</span>)</span> &lt;= <span class="mxinfo  sgl" id="T1:U502"><span class="mxinfo  sgl" id="T1:U503">2*<span class="var type1 sgl" id="S4T1U682">W</span></span>+1</span></span>)</span> &amp; (<span class="mxinfo " id="T10:U505"><span class="mxinfo  sgl" id="T1:U506">1</span> &lt;= <span class="mxinfo " id="T4:U507"><span class="var type1 sgl" id="S16T3U688">pixrot</span>(<span class="mxinfo " id="T1:U509">2</span>,<span class="mxinfo " id="T8:U510">:</span>)</span></span>)</span> &amp; (<span class="mxinfo  sgl" id="T10:U511"><span class="mxinfo " id="T4:U512"><span class="var type1 sgl" id="S16T3U694">pixrot</span>(<span class="mxinfo " id="T1:U514">2</span>,<span class="mxinfo  sgl" id="T8:U515">:</span>)</span> &lt;= <span class="mxinfo  sgl" id="T1:U516"><span class="mxinfo  sgl" id="T1:U517">2*<span class="var type1 sgl" id="S3T1U700">H</span></span>+1</span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">        <span class="mxinfo " id="T3:U519"><span class="var type1" id="S16T3U704">pixrot</span>      = <span class="mxinfo  sgl" id="T3:U521">round(<span class="var type1 sgl" id="S16T3U707">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">        <span class="mxinfo " id="T4:U523"><span class="var type1" id="S18T4U710">index</span> = <span class="mxinfo  sgl" id="T4:U525"><span class="message warning" id="M6F1C">sub2ind(<span class="mxinfo " id="T6:U526">[<span class="mxinfo  sgl" id="T1:U527"><span class="mxinfo  sgl" id="T1:U528">2*<span class="var type1 sgl" id="S3T1U718">H</span></span>+1</span>, <span class="mxinfo " id="T1:U530"><span class="mxinfo " id="T1:U531">2*<span class="var type1" id="S4T1U723">W</span></span>+1</span>]</span>, <span class="mxinfo  sgl" id="T4:U533"><span class="var type1" id="S16T3U726">pixrot</span>(<span class="mxinfo " id="T7:U535">2</span>,<span class="mxinfo  sgl" id="T8:U536">:</span>)</span>, <span class="mxinfo  sgl" id="T4:U537"><span class="var type1" id="S16T3U730">pixrot</span>(<span class="mxinfo " id="T7:U539">1</span>,<span class="mxinfo  sgl" id="T8:U540">:</span>)</span> )</span></span></span>;     </span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">        <span class="mxinfo  sgl" id="T4:U541"><span class="mxinfo  sgl" id="T4:U542"><span class="var type1 sgl" id="S2T2U736">TEMPLATE</span>(<span class="var type1" id="S18T4U737">index</span>)</span> = <span class="mxinfo  sgl" id="T1:U545">rad2deg(<span class="var type1" id="S9T1U740">an</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="comment">%% fill in holes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">    <span class="mxinfo  sgl" id="T2:U547"><span class="var type1" id="S2T2U743">TEMPLATE</span> = <span class="mxinfo  sgl" id="T2:U549">imdilate( <span class="var type1 sgl" id="S2T2U746">TEMPLATE</span>, ones(3,3) )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">    <span class="mxinfo  sgl" id="T2:U551"><span class="mxinfo  sgl" id="T2:U552"><span class="var type1 sgl" id="S2T2U754">TEMPLATE</span>(<span class="mxinfo " id="T4:U554"><span class="mxinfo  sgl" id="T1:U555">1</span>:<span class="mxinfo  sgl" id="T1:U556"><span class="var type1 sgl" id="S3T1U758">H</span>+2</span></span>,<span class="mxinfo  sgl" id="T8:U558">:</span>)</span> = <span class="mxinfo  sgl" id="T1:U559">-<span class="mxinfo " id="T1:U560">180</span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
