<pre class="code">
<span class="srcline"><span class="lineno"><a href="93,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%% create edge template</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,8" id="srcline8">  8</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T3U3">TEMPLATE</span>] = createTemplate( <span class="var type1" id="S3T16U6">H</span> ,<span class="var type1" id="S4T16U7">W</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="93,9" id="srcline9">  9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,10" id="srcline10"> 10</a></span><span class="line">    <span class="comment">%% empty template</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,11" id="srcline11"> 11</a></span><span class="line">    <span class="mxinfo " id="T3:U4"><span class="var type1" id="S2T3U10">TEMPLATE</span> = <span class="mxinfo " id="T3:U6"><span class="mxinfo " id="T6:U7">-180</span> * <span class="mxinfo " id="T3:U8">ones( <span class="mxinfo " id="T16:U9"><span class="mxinfo " id="T16:U10">2*<span class="var type1" id="S3T16U19">H</span></span>+<span class="mxinfo " id="T6:U12">1</span></span>, <span class="mxinfo " id="T16:U13"><span class="mxinfo " id="T16:U14">2*<span class="var type1" id="S4T16U24">W</span></span>+<span class="mxinfo " id="T6:U16">1</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo " id="T43:U17"><span class="var type1" id="S6T43U28">pix</span>      = <span class="mxinfo " id="T43:U19">[<span class="mxinfo " id="T17:U20"><span class="mxinfo " id="T16:U21">-2*<span class="var type1" id="S4T16U35">W</span></span>:<span class="mxinfo " id="T16:U23">2*<span class="var type1" id="S4T16U38">W</span></span></span>;<span class="mxinfo " id="T19:U25">zeros(<span class="mxinfo " id="T6:U26">1</span>,<span class="mxinfo " id="T16:U27"><span class="mxinfo " id="T16:U28">4*<span class="var type1" id="S4T16U46">W</span></span>+<span class="mxinfo " id="T6:U30">1</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,13" id="srcline13"> 13</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="93,14" id="srcline14"> 14</a></span><span class="line">    <span class="comment">%% left border</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,15" id="srcline15"> 15</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S8T16U50">h</span> = <span class="mxinfo " id="T16:U32"><span class="var type1" id="S3T16U53">H</span>+<span class="mxinfo " id="T6:U34">1</span></span>:<span class="mxinfo " id="T16:U35"><span class="mxinfo " id="T16:U36">2*<span class="var type1" id="S3T16U58">H</span></span>+<span class="mxinfo " id="T6:U38">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="93,16" id="srcline16"> 16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,17" id="srcline17"> 17</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,18" id="srcline18"> 18</a></span><span class="line">        <span class="mxinfo " id="T16:U39"><span class="var type1" id="S9T16U62">an</span> = <span class="mxinfo " id="T16:U41">atan( <span class="mxinfo " id="T16:U42">(<span class="mxinfo " id="T16:U43"><span class="var type1" id="S8T16U68">h</span>-(<span class="mxinfo " id="T16:U45"><span class="var type1" id="S3T16U71">H</span>+<span class="mxinfo " id="T6:U47">1</span></span>)</span>) / <span class="var type1" id="S4T16U73">W</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,19" id="srcline19"> 19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,20" id="srcline20"> 20</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,21" id="srcline21"> 21</a></span><span class="line">        <span class="mxinfo " id="T16:U49"><span class="var type1" id="S11T16U76">cs</span>     = <span class="mxinfo " id="T16:U51">cos(<span class="mxinfo " id="T16:U52">-<span class="var type1" id="S9T16U80">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="93,22" id="srcline22"> 22</a></span><span class="line">        <span class="mxinfo " id="T16:U54"><span class="var type1" id="S13T16U83">sn</span>     = <span class="mxinfo " id="T16:U56">sin(<span class="mxinfo " id="T16:U57">-<span class="var type1" id="S9T16U87">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,23" id="srcline23"> 23</a></span><span class="line">        <span class="mxinfo " id="T50:U59"><span class="var type1" id="S15T50U90">rot</span>    = <span class="mxinfo " id="T50:U61">[<span class="mxinfo " id="T15:U62"><span class="var type1" id="S11T16U93">cs</span> <span class="mxinfo " id="T16:U64">-<span class="var type1" id="S13T16U95">sn</span></span></span>; <span class="mxinfo " id="T15:U66"><span class="var type1" id="S13T16U97">sn</span> <span class="var type1" id="S11T16U98">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,24" id="srcline24"> 24</a></span><span class="line">        <span class="mxinfo " id="T43:U69"><span class="var type1" id="S16T43U101">pixrot</span> = <span class="mxinfo " id="T43:U71"><span class="var type1" id="S15T50U103">rot</span>*<span class="var type1" id="S6T43U104">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,25" id="srcline25"> 25</a></span><span class="line">        <span class="mxinfo " id="T17:U74"><span class="mxinfo " id="T17:U75"><span class="var type1" id="S16T43U108">pixrot</span>(<span class="mxinfo " id="T14:U77">1</span>,<span class="mxinfo " id="T18:U78">:</span>)</span> = <span class="mxinfo " id="T17:U79"><span class="mxinfo " id="T17:U80"><span class="mxinfo " id="T17:U81"><span class="var type1" id="S16T43U114">pixrot</span>(<span class="mxinfo " id="T6:U83">1</span>,<span class="mxinfo " id="T18:U84">:</span>)</span> + <span class="var type1" id="S4T16U117">W</span></span>+<span class="mxinfo " id="T6:U86">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,26" id="srcline26"> 26</a></span><span class="line">        <span class="mxinfo " id="T17:U87"><span class="mxinfo " id="T17:U88"><span class="var type1" id="S16T43U122">pixrot</span>(<span class="mxinfo " id="T14:U90">2</span>,<span class="mxinfo " id="T18:U91">:</span>)</span> = <span class="mxinfo " id="T17:U92"><span class="mxinfo " id="T17:U93"><span class="mxinfo " id="T17:U94"><span class="var type1" id="S16T43U128">pixrot</span>(<span class="mxinfo " id="T6:U96">2</span>,<span class="mxinfo " id="T18:U97">:</span>)</span> + <span class="var type1" id="S3T16U131">H</span></span>+<span class="mxinfo " id="T6:U99">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="93,27" id="srcline27"> 27</a></span><span class="line">        <span class="mxinfo " id="T43:U100"><span class="var type1" id="S16T43U135">pixrot</span>      = <span class="mxinfo " id="T43:U102"><span class="var type1" id="S16T43U137">pixrot</span>(<span class="mxinfo " id="T55:U104">:</span>, <span class="mxinfo " id="T95:U105"><span class="mxinfo " id="T95:U106"><span class="mxinfo " id="T95:U107">(<span class="mxinfo " id="T95:U108"><span class="mxinfo " id="T6:U109">1</span> &lt;= <span class="mxinfo " id="T17:U110"><span class="var type1" id="S16T43U146">pixrot</span>(<span class="mxinfo " id="T6:U112">1</span>,<span class="mxinfo " id="T18:U113">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T95:U114"><span class="mxinfo " id="T17:U115"><span class="var type1" id="S16T43U152">pixrot</span>(<span class="mxinfo " id="T6:U117">1</span>,<span class="mxinfo " id="T18:U118">:</span>)</span> &lt;= <span class="mxinfo " id="T16:U119"><span class="mxinfo " id="T16:U120">2*<span class="var type1" id="S4T16U158">W</span></span>+<span class="mxinfo " id="T6:U122">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T95:U123"><span class="mxinfo " id="T6:U124">1</span> &lt;= <span class="mxinfo " id="T17:U125"><span class="var type1" id="S16T43U164">pixrot</span>(<span class="mxinfo " id="T6:U127">2</span>,<span class="mxinfo " id="T18:U128">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T95:U129"><span class="mxinfo " id="T17:U130"><span class="var type1" id="S16T43U170">pixrot</span>(<span class="mxinfo " id="T6:U132">2</span>,<span class="mxinfo " id="T18:U133">:</span>)</span> &lt;= <span class="mxinfo " id="T16:U134"><span class="mxinfo " id="T16:U135">2*<span class="var type1" id="S3T16U176">H</span></span>+<span class="mxinfo " id="T6:U137">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,28" id="srcline28"> 28</a></span><span class="line">        <span class="mxinfo " id="T43:U138"><span class="var type1" id="S16T43U180">pixrot</span>      = <span class="mxinfo " id="T43:U140">round(<span class="var type1" id="S16T43U183">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,29" id="srcline29"> 29</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="93,30" id="srcline30"> 30</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,31" id="srcline31"> 31</a></span><span class="line">        <span class="mxinfo " id="T19:U142"><span class="var type1" id="S18T19U186">index</span> = <span class="mxinfo " id="T19:U144">sub2ind(<span class="mxinfo " id="T15:U145">[<span class="mxinfo " id="T16:U146"><span class="mxinfo " id="T16:U147">2*<span class="var type1" id="S3T16U194">H</span></span>+<span class="mxinfo " id="T6:U149">1</span></span>, <span class="mxinfo " id="T16:U150"><span class="mxinfo " id="T16:U151">2*<span class="var type1" id="S4T16U199">W</span></span>+<span class="mxinfo " id="T6:U153">1</span></span>]</span>, <span class="mxinfo " id="T17:U154"><span class="var type1" id="S16T43U202">pixrot</span>(<span class="mxinfo " id="T14:U156">2</span>,<span class="mxinfo " id="T18:U157">:</span>)</span>, <span class="mxinfo " id="T17:U158"><span class="var type1" id="S16T43U206">pixrot</span>(<span class="mxinfo " id="T14:U160">1</span>,<span class="mxinfo " id="T18:U161">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,33" id="srcline33"> 33</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,34" id="srcline34"> 34</a></span><span class="line">        <span class="mxinfo " id="T19:U162"><span class="mxinfo " id="T19:U163"><span class="var type1" id="S2T3U212">TEMPLATE</span>(<span class="var type1" id="S18T19U213">index</span>)</span> = <span class="mxinfo " id="T16:U166">rad2deg(<span class="var type1" id="S9T16U216">an</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="93,35" id="srcline35"> 35</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,36" id="srcline36"> 36</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="93,37" id="srcline37"> 37</a></span><span class="line">    <span class="comment">%% bottom border left part</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,38" id="srcline38"> 38</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T16U219">w</span> = <span class="var type1" id="S4T16U222">W</span>:<span class="mxinfo " id="T16:U170">-1</span>:<span class="mxinfo " id="T16:U171">0</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,39" id="srcline39"> 39</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="93,40" id="srcline40"> 40</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,41" id="srcline41"> 41</a></span><span class="line">        <span class="mxinfo " id="T16:U172"><span class="var type1" id="S9T16U228">an</span> = <span class="mxinfo " id="T16:U174"><span class="mxinfo " id="T6:U175"><span class="mxinfo " id="T6:U176">pi</span>/<span class="mxinfo " id="T6:U177">2</span></span>-<span class="mxinfo " id="T16:U178">atan( <span class="mxinfo " id="T16:U179"><span class="var type1" id="S21T16U237">w</span> / <span class="var type1" id="S3T16U238">H</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,42" id="srcline42"> 42</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="93,43" id="srcline43"> 43</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,44" id="srcline44"> 44</a></span><span class="line">        <span class="mxinfo " id="T16:U182"><span class="var type1" id="S11T16U241">cs</span>     = <span class="mxinfo " id="T16:U184">cos(<span class="mxinfo " id="T16:U185">-<span class="var type1" id="S9T16U245">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="93,45" id="srcline45"> 45</a></span><span class="line">        <span class="mxinfo " id="T16:U187"><span class="var type1" id="S13T16U248">sn</span>     = <span class="mxinfo " id="T16:U189">sin(<span class="mxinfo " id="T16:U190">-<span class="var type1" id="S9T16U252">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,46" id="srcline46"> 46</a></span><span class="line">        <span class="mxinfo " id="T50:U192"><span class="var type1" id="S15T50U255">rot</span>    = <span class="mxinfo " id="T50:U194">[<span class="mxinfo " id="T15:U195"><span class="var type1" id="S11T16U258">cs</span> <span class="mxinfo " id="T16:U197">-<span class="var type1" id="S13T16U260">sn</span></span></span>; <span class="mxinfo " id="T15:U199"><span class="var type1" id="S13T16U262">sn</span> <span class="var type1" id="S11T16U263">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,47" id="srcline47"> 47</a></span><span class="line">        <span class="mxinfo " id="T43:U202"><span class="var type1" id="S16T43U266">pixrot</span> = <span class="mxinfo " id="T43:U204"><span class="var type1" id="S15T50U268">rot</span>*<span class="var type1" id="S6T43U269">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,48" id="srcline48"> 48</a></span><span class="line">        <span class="mxinfo " id="T17:U207"><span class="mxinfo " id="T17:U208"><span class="var type1" id="S16T43U273">pixrot</span>(<span class="mxinfo " id="T14:U210">1</span>,<span class="mxinfo " id="T18:U211">:</span>)</span> = <span class="mxinfo " id="T17:U212"><span class="mxinfo " id="T17:U213"><span class="mxinfo " id="T17:U214"><span class="var type1" id="S16T43U279">pixrot</span>(<span class="mxinfo " id="T6:U216">1</span>,<span class="mxinfo " id="T18:U217">:</span>)</span> + <span class="var type1" id="S4T16U282">W</span></span>+<span class="mxinfo " id="T6:U219">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,49" id="srcline49"> 49</a></span><span class="line">        <span class="mxinfo " id="T17:U220"><span class="mxinfo " id="T17:U221"><span class="var type1" id="S16T43U287">pixrot</span>(<span class="mxinfo " id="T14:U223">2</span>,<span class="mxinfo " id="T18:U224">:</span>)</span> = <span class="mxinfo " id="T17:U225"><span class="mxinfo " id="T17:U226"><span class="mxinfo " id="T17:U227"><span class="var type1" id="S16T43U293">pixrot</span>(<span class="mxinfo " id="T6:U229">2</span>,<span class="mxinfo " id="T18:U230">:</span>)</span> + <span class="var type1" id="S3T16U296">H</span></span>+<span class="mxinfo " id="T6:U232">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="93,50" id="srcline50"> 50</a></span><span class="line">        <span class="mxinfo " id="T43:U233"><span class="var type1" id="S16T43U300">pixrot</span>      = <span class="mxinfo " id="T43:U235"><span class="var type1" id="S16T43U302">pixrot</span>(<span class="mxinfo " id="T55:U237">:</span>, <span class="mxinfo " id="T95:U238"><span class="mxinfo " id="T95:U239"><span class="mxinfo " id="T95:U240">(<span class="mxinfo " id="T95:U241"><span class="mxinfo " id="T6:U242">1</span> &lt;= <span class="mxinfo " id="T17:U243"><span class="var type1" id="S16T43U311">pixrot</span>(<span class="mxinfo " id="T6:U245">1</span>,<span class="mxinfo " id="T18:U246">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T95:U247"><span class="mxinfo " id="T17:U248"><span class="var type1" id="S16T43U317">pixrot</span>(<span class="mxinfo " id="T6:U250">1</span>,<span class="mxinfo " id="T18:U251">:</span>)</span> &lt;= <span class="mxinfo " id="T16:U252"><span class="mxinfo " id="T16:U253">2*<span class="var type1" id="S4T16U323">W</span></span>+<span class="mxinfo " id="T6:U255">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T95:U256"><span class="mxinfo " id="T6:U257">1</span> &lt;= <span class="mxinfo " id="T17:U258"><span class="var type1" id="S16T43U329">pixrot</span>(<span class="mxinfo " id="T6:U260">2</span>,<span class="mxinfo " id="T18:U261">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T95:U262"><span class="mxinfo " id="T17:U263"><span class="var type1" id="S16T43U335">pixrot</span>(<span class="mxinfo " id="T6:U265">2</span>,<span class="mxinfo " id="T18:U266">:</span>)</span> &lt;= <span class="mxinfo " id="T16:U267"><span class="mxinfo " id="T16:U268">2*<span class="var type1" id="S3T16U341">H</span></span>+<span class="mxinfo " id="T6:U270">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,51" id="srcline51"> 51</a></span><span class="line">        <span class="mxinfo " id="T43:U271"><span class="var type1" id="S16T43U345">pixrot</span>      = <span class="mxinfo " id="T43:U273">round(<span class="var type1" id="S16T43U348">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,52" id="srcline52"> 52</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="93,53" id="srcline53"> 53</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,54" id="srcline54"> 54</a></span><span class="line">        <span class="mxinfo " id="T19:U275"><span class="var type1" id="S18T19U351">index</span> = <span class="mxinfo " id="T19:U277">sub2ind(<span class="mxinfo " id="T15:U278">[<span class="mxinfo " id="T16:U279"><span class="mxinfo " id="T16:U280">2*<span class="var type1" id="S3T16U359">H</span></span>+<span class="mxinfo " id="T6:U282">1</span></span>, <span class="mxinfo " id="T16:U283"><span class="mxinfo " id="T16:U284">2*<span class="var type1" id="S4T16U364">W</span></span>+<span class="mxinfo " id="T6:U286">1</span></span>]</span>, <span class="mxinfo " id="T17:U287"><span class="var type1" id="S16T43U367">pixrot</span>(<span class="mxinfo " id="T14:U289">2</span>,<span class="mxinfo " id="T18:U290">:</span>)</span>, <span class="mxinfo " id="T17:U291"><span class="var type1" id="S16T43U371">pixrot</span>(<span class="mxinfo " id="T14:U293">1</span>,<span class="mxinfo " id="T18:U294">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,55" id="srcline55"> 55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,56" id="srcline56"> 56</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo " id="T19:U295"><span class="mxinfo " id="T19:U296"><span class="var type1" id="S2T3U377">TEMPLATE</span>(<span class="var type1" id="S18T19U378">index</span>)</span> = <span class="mxinfo " id="T16:U299">rad2deg(<span class="var type1" id="S9T16U381">an</span>)</span></span>;         </span></span>
<span class="srcline"><span class="lineno"><a href="93,58" id="srcline58"> 58</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,60" id="srcline60"> 60</a></span><span class="line">    <span class="comment">%% bottom border rithg part</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,61" id="srcline61"> 61</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T16U384">w</span> = <span class="var type1" id="S4T16U387">W</span>:<span class="mxinfo " id="T16:U303">-1</span>:<span class="mxinfo " id="T16:U304">0</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,62" id="srcline62"> 62</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="93,63" id="srcline63"> 63</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,64" id="srcline64"> 64</a></span><span class="line">        <span class="mxinfo " id="T16:U305"><span class="var type1" id="S9T16U393">an</span> = <span class="mxinfo " id="T16:U307"><span class="mxinfo " id="T6:U308"><span class="mxinfo " id="T6:U309">pi</span>/<span class="mxinfo " id="T6:U310">2</span></span>+<span class="mxinfo " id="T16:U311">atan( <span class="mxinfo " id="T16:U312"><span class="var type1" id="S21T16U402">w</span> / <span class="var type1" id="S3T16U403">H</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,65" id="srcline65"> 65</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="93,66" id="srcline66"> 66</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,67" id="srcline67"> 67</a></span><span class="line">        <span class="mxinfo " id="T16:U315"><span class="var type1" id="S11T16U406">cs</span>     = <span class="mxinfo " id="T16:U317">cos(<span class="mxinfo " id="T16:U318">-<span class="var type1" id="S9T16U410">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="93,68" id="srcline68"> 68</a></span><span class="line">        <span class="mxinfo " id="T16:U320"><span class="var type1" id="S13T16U413">sn</span>     = <span class="mxinfo " id="T16:U322">sin(<span class="mxinfo " id="T16:U323">-<span class="var type1" id="S9T16U417">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,69" id="srcline69"> 69</a></span><span class="line">        <span class="mxinfo " id="T50:U325"><span class="var type1" id="S15T50U420">rot</span>    = <span class="mxinfo " id="T50:U327">[<span class="mxinfo " id="T15:U328"><span class="var type1" id="S11T16U423">cs</span> <span class="mxinfo " id="T16:U330">-<span class="var type1" id="S13T16U425">sn</span></span></span>; <span class="mxinfo " id="T15:U332"><span class="var type1" id="S13T16U427">sn</span> <span class="var type1" id="S11T16U428">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,70" id="srcline70"> 70</a></span><span class="line">        <span class="mxinfo " id="T43:U335"><span class="var type1" id="S16T43U431">pixrot</span> = <span class="mxinfo " id="T43:U337"><span class="var type1" id="S15T50U433">rot</span>*<span class="var type1" id="S6T43U434">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,71" id="srcline71"> 71</a></span><span class="line">        <span class="mxinfo " id="T17:U340"><span class="mxinfo " id="T17:U341"><span class="var type1" id="S16T43U438">pixrot</span>(<span class="mxinfo " id="T14:U343">1</span>,<span class="mxinfo " id="T18:U344">:</span>)</span> = <span class="mxinfo " id="T17:U345"><span class="mxinfo " id="T17:U346"><span class="mxinfo " id="T17:U347"><span class="var type1" id="S16T43U444">pixrot</span>(<span class="mxinfo " id="T6:U349">1</span>,<span class="mxinfo " id="T18:U350">:</span>)</span> + <span class="var type1" id="S4T16U447">W</span></span>+<span class="mxinfo " id="T6:U352">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,72" id="srcline72"> 72</a></span><span class="line">        <span class="mxinfo " id="T17:U353"><span class="mxinfo " id="T17:U354"><span class="var type1" id="S16T43U452">pixrot</span>(<span class="mxinfo " id="T14:U356">2</span>,<span class="mxinfo " id="T18:U357">:</span>)</span> = <span class="mxinfo " id="T17:U358"><span class="mxinfo " id="T17:U359"><span class="mxinfo " id="T17:U360"><span class="var type1" id="S16T43U458">pixrot</span>(<span class="mxinfo " id="T6:U362">2</span>,<span class="mxinfo " id="T18:U363">:</span>)</span> + <span class="var type1" id="S3T16U461">H</span></span>+<span class="mxinfo " id="T6:U365">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="93,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo " id="T43:U366"><span class="var type1" id="S16T43U465">pixrot</span>      = <span class="mxinfo " id="T43:U368"><span class="var type1" id="S16T43U467">pixrot</span>(<span class="mxinfo " id="T55:U370">:</span>, <span class="mxinfo " id="T95:U371"><span class="mxinfo " id="T95:U372"><span class="mxinfo " id="T95:U373">(<span class="mxinfo " id="T95:U374"><span class="mxinfo " id="T6:U375">1</span> &lt;= <span class="mxinfo " id="T17:U376"><span class="var type1" id="S16T43U476">pixrot</span>(<span class="mxinfo " id="T6:U378">1</span>,<span class="mxinfo " id="T18:U379">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T95:U380"><span class="mxinfo " id="T17:U381"><span class="var type1" id="S16T43U482">pixrot</span>(<span class="mxinfo " id="T6:U383">1</span>,<span class="mxinfo " id="T18:U384">:</span>)</span> &lt;= <span class="mxinfo " id="T16:U385"><span class="mxinfo " id="T16:U386">2*<span class="var type1" id="S4T16U488">W</span></span>+<span class="mxinfo " id="T6:U388">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T95:U389"><span class="mxinfo " id="T6:U390">1</span> &lt;= <span class="mxinfo " id="T17:U391"><span class="var type1" id="S16T43U494">pixrot</span>(<span class="mxinfo " id="T6:U393">2</span>,<span class="mxinfo " id="T18:U394">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T95:U395"><span class="mxinfo " id="T17:U396"><span class="var type1" id="S16T43U500">pixrot</span>(<span class="mxinfo " id="T6:U398">2</span>,<span class="mxinfo " id="T18:U399">:</span>)</span> &lt;= <span class="mxinfo " id="T16:U400"><span class="mxinfo " id="T16:U401">2*<span class="var type1" id="S3T16U506">H</span></span>+<span class="mxinfo " id="T6:U403">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,74" id="srcline74"> 74</a></span><span class="line">        <span class="mxinfo " id="T43:U404"><span class="var type1" id="S16T43U510">pixrot</span>      = <span class="mxinfo " id="T43:U406">round(<span class="var type1" id="S16T43U513">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,75" id="srcline75"> 75</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="93,76" id="srcline76"> 76</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,77" id="srcline77"> 77</a></span><span class="line">        <span class="mxinfo " id="T19:U408"><span class="var type1" id="S18T19U516">index</span> = <span class="mxinfo " id="T19:U410">sub2ind(<span class="mxinfo " id="T15:U411">[<span class="mxinfo " id="T16:U412"><span class="mxinfo " id="T16:U413">2*<span class="var type1" id="S3T16U524">H</span></span>+<span class="mxinfo " id="T6:U415">1</span></span>, <span class="mxinfo " id="T16:U416"><span class="mxinfo " id="T16:U417">2*<span class="var type1" id="S4T16U529">W</span></span>+<span class="mxinfo " id="T6:U419">1</span></span>]</span>, <span class="mxinfo " id="T17:U420"><span class="var type1" id="S16T43U532">pixrot</span>(<span class="mxinfo " id="T14:U422">2</span>,<span class="mxinfo " id="T18:U423">:</span>)</span>, <span class="mxinfo " id="T17:U424"><span class="var type1" id="S16T43U536">pixrot</span>(<span class="mxinfo " id="T14:U426">1</span>,<span class="mxinfo " id="T18:U427">:</span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,79" id="srcline79"> 79</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,80" id="srcline80"> 80</a></span><span class="line">        <span class="mxinfo " id="T19:U428"><span class="mxinfo " id="T19:U429"><span class="var type1" id="S2T3U542">TEMPLATE</span>(<span class="var type1" id="S18T19U543">index</span>)</span> = <span class="mxinfo " id="T16:U432">rad2deg(<span class="var type1" id="S9T16U546">an</span>)</span></span>;         </span></span>
<span class="srcline"><span class="lineno"><a href="93,81" id="srcline81"> 81</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,82" id="srcline82"> 82</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,83" id="srcline83"> 83</a></span><span class="line">    <span class="comment">%% right border</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,84" id="srcline84"> 84</a></span><span class="line">    <span class="mxinfo " id="T43:U434"><span class="var type1" id="S6T43U549">pix</span> = <span class="mxinfo " id="T43:U436">[<span class="mxinfo " id="T17:U437"><span class="mxinfo " id="T16:U438">-2*<span class="var type1" id="S4T16U556">W</span></span>:<span class="mxinfo " id="T16:U440">2*<span class="var type1" id="S4T16U559">W</span></span></span>;<span class="mxinfo " id="T19:U442">zeros(<span class="mxinfo " id="T6:U443">1</span>,<span class="mxinfo " id="T16:U444"><span class="mxinfo " id="T16:U445">4*<span class="var type1" id="S4T16U567">W</span></span>+<span class="mxinfo " id="T6:U447">1</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,85" id="srcline85"> 85</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S8T16U571">h</span> = <span class="mxinfo " id="T16:U449"><span class="var type1" id="S3T16U574">H</span>+<span class="mxinfo " id="T6:U451">1</span></span>:<span class="mxinfo " id="T16:U452"><span class="mxinfo " id="T16:U453">2*<span class="var type1" id="S3T16U579">H</span></span>+<span class="mxinfo " id="T6:U455">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="93,86" id="srcline86"> 86</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,87" id="srcline87"> 87</a></span><span class="line">        <span class="comment">%% angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,88" id="srcline88"> 88</a></span><span class="line">        <span class="mxinfo " id="T16:U456"><span class="var type1" id="S9T16U583">an</span> = <span class="mxinfo " id="T16:U458"><span class="mxinfo " id="T6:U459">pi</span>-<span class="mxinfo " id="T16:U460">atan( <span class="mxinfo " id="T16:U461">(<span class="mxinfo " id="T16:U462"><span class="var type1" id="S8T16U592">h</span>-(<span class="mxinfo " id="T16:U464"><span class="var type1" id="S3T16U595">H</span>+<span class="mxinfo " id="T6:U466">1</span></span>)</span>) / <span class="var type1" id="S4T16U597">W</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,89" id="srcline89"> 89</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="93,90" id="srcline90"> 90</a></span><span class="line">        <span class="comment">%% draw in template</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,91" id="srcline91"> 91</a></span><span class="line">        <span class="mxinfo " id="T16:U468"><span class="var type1" id="S11T16U600">cs</span>     = <span class="mxinfo " id="T16:U470">cos(<span class="mxinfo " id="T16:U471">-<span class="var type1" id="S9T16U604">an</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="93,92" id="srcline92"> 92</a></span><span class="line">        <span class="mxinfo " id="T16:U473"><span class="var type1" id="S13T16U607">sn</span>     = <span class="mxinfo " id="T16:U475">sin(<span class="mxinfo " id="T16:U476">-<span class="var type1" id="S9T16U611">an</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,93" id="srcline93"> 93</a></span><span class="line">        <span class="mxinfo " id="T50:U478"><span class="var type1" id="S15T50U614">rot</span>    = <span class="mxinfo " id="T50:U480">[<span class="mxinfo " id="T15:U481"><span class="var type1" id="S11T16U617">cs</span> <span class="mxinfo " id="T16:U483">-<span class="var type1" id="S13T16U619">sn</span></span></span>; <span class="mxinfo " id="T15:U485"><span class="var type1" id="S13T16U621">sn</span> <span class="var type1" id="S11T16U622">cs</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,94" id="srcline94"> 94</a></span><span class="line">        <span class="mxinfo " id="T43:U488"><span class="var type1" id="S16T43U625">pixrot</span> = <span class="mxinfo " id="T43:U490"><span class="var type1" id="S15T50U627">rot</span>*<span class="var type1" id="S6T43U628">pix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,95" id="srcline95"> 95</a></span><span class="line">        <span class="mxinfo " id="T17:U493"><span class="mxinfo " id="T17:U494"><span class="var type1" id="S16T43U632">pixrot</span>(<span class="mxinfo " id="T14:U496">1</span>,<span class="mxinfo " id="T18:U497">:</span>)</span> = <span class="mxinfo " id="T17:U498"><span class="mxinfo " id="T17:U499"><span class="mxinfo " id="T17:U500"><span class="var type1" id="S16T43U638">pixrot</span>(<span class="mxinfo " id="T6:U502">1</span>,<span class="mxinfo " id="T18:U503">:</span>)</span> + <span class="var type1" id="S4T16U641">W</span></span>+<span class="mxinfo " id="T6:U505">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,96" id="srcline96"> 96</a></span><span class="line">        <span class="mxinfo " id="T17:U506"><span class="mxinfo " id="T17:U507"><span class="var type1" id="S16T43U646">pixrot</span>(<span class="mxinfo " id="T14:U509">2</span>,<span class="mxinfo " id="T18:U510">:</span>)</span> = <span class="mxinfo " id="T17:U511"><span class="mxinfo " id="T17:U512"><span class="mxinfo " id="T17:U513"><span class="var type1" id="S16T43U652">pixrot</span>(<span class="mxinfo " id="T6:U515">2</span>,<span class="mxinfo " id="T18:U516">:</span>)</span> + <span class="var type1" id="S3T16U655">H</span></span>+<span class="mxinfo " id="T6:U518">1</span></span></span>;             </span></span>
<span class="srcline"><span class="lineno"><a href="93,97" id="srcline97"> 97</a></span><span class="line">        <span class="mxinfo " id="T43:U519"><span class="var type1" id="S16T43U659">pixrot</span>      = <span class="mxinfo " id="T43:U521"><span class="var type1" id="S16T43U661">pixrot</span>(<span class="mxinfo " id="T55:U523">:</span>, <span class="mxinfo " id="T95:U524"><span class="mxinfo " id="T95:U525"><span class="mxinfo " id="T95:U526">(<span class="mxinfo " id="T95:U527"><span class="mxinfo " id="T6:U528">1</span> &lt;= <span class="mxinfo " id="T17:U529"><span class="var type1" id="S16T43U670">pixrot</span>(<span class="mxinfo " id="T6:U531">1</span>,<span class="mxinfo " id="T18:U532">:</span>)</span></span>) &amp; (<span class="mxinfo " id="T95:U533"><span class="mxinfo " id="T17:U534"><span class="var type1" id="S16T43U676">pixrot</span>(<span class="mxinfo " id="T6:U536">1</span>,<span class="mxinfo " id="T18:U537">:</span>)</span> &lt;= <span class="mxinfo " id="T16:U538"><span class="mxinfo " id="T16:U539">2*<span class="var type1" id="S4T16U682">W</span></span>+<span class="mxinfo " id="T6:U541">1</span></span></span>)</span> &amp; (<span class="mxinfo " id="T95:U542"><span class="mxinfo " id="T6:U543">1</span> &lt;= <span class="mxinfo " id="T17:U544"><span class="var type1" id="S16T43U688">pixrot</span>(<span class="mxinfo " id="T6:U546">2</span>,<span class="mxinfo " id="T18:U547">:</span>)</span></span>)</span> &amp; (<span class="mxinfo " id="T95:U548"><span class="mxinfo " id="T17:U549"><span class="var type1" id="S16T43U694">pixrot</span>(<span class="mxinfo " id="T6:U551">2</span>,<span class="mxinfo " id="T18:U552">:</span>)</span> &lt;= <span class="mxinfo " id="T16:U553"><span class="mxinfo " id="T16:U554">2*<span class="var type1" id="S3T16U700">H</span></span>+<span class="mxinfo " id="T6:U556">1</span></span></span>)</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,98" id="srcline98"> 98</a></span><span class="line">        <span class="mxinfo " id="T43:U557"><span class="var type1" id="S16T43U704">pixrot</span>      = <span class="mxinfo " id="T43:U559">round(<span class="var type1" id="S16T43U707">pixrot</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,99" id="srcline99"> 99</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="93,100" id="srcline100">100</a></span><span class="line">        <span class="comment">%% get indices of the vanashing line</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,101" id="srcline101">101</a></span><span class="line">        <span class="mxinfo " id="T19:U561"><span class="var type1" id="S18T19U710">index</span> = <span class="mxinfo " id="T19:U563">sub2ind(<span class="mxinfo " id="T15:U564">[<span class="mxinfo " id="T16:U565"><span class="mxinfo " id="T16:U566">2*<span class="var type1" id="S3T16U718">H</span></span>+<span class="mxinfo " id="T6:U568">1</span></span>, <span class="mxinfo " id="T16:U569"><span class="mxinfo " id="T16:U570">2*<span class="var type1" id="S4T16U723">W</span></span>+<span class="mxinfo " id="T6:U572">1</span></span>]</span>, <span class="mxinfo " id="T17:U573"><span class="var type1" id="S16T43U726">pixrot</span>(<span class="mxinfo " id="T14:U575">2</span>,<span class="mxinfo " id="T18:U576">:</span>)</span>, <span class="mxinfo " id="T17:U577"><span class="var type1" id="S16T43U730">pixrot</span>(<span class="mxinfo " id="T14:U579">1</span>,<span class="mxinfo " id="T18:U580">:</span>)</span> )</span></span>;     </span></span>
<span class="srcline"><span class="lineno"><a href="93,102" id="srcline102">102</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="93,103" id="srcline103">103</a></span><span class="line">        <span class="comment">%% draw</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,104" id="srcline104">104</a></span><span class="line">        <span class="mxinfo " id="T19:U581"><span class="mxinfo " id="T19:U582"><span class="var type1" id="S2T3U736">TEMPLATE</span>(<span class="var type1" id="S18T19U737">index</span>)</span> = <span class="mxinfo " id="T16:U585">rad2deg(<span class="var type1" id="S9T16U740">an</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="93,105" id="srcline105">105</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,106" id="srcline106">106</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="93,107" id="srcline107">107</a></span><span class="line">    <span class="comment">%% fill in holes</span></span></span>
<span class="srcline"><span class="lineno"><a href="93,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T3:U587"><span class="var type1" id="S2T3U743">TEMPLATE</span> = <span class="mxinfo " id="T3:U589">imdilate( <span class="var type1" id="S2T3U746">TEMPLATE</span>, ones(<span class="mxinfo " id="T6:U591">3</span>,<span class="mxinfo " id="T6:U592">3</span>) )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="93,109" id="srcline109">109</a></span><span class="line">    <span class="mxinfo " id="T3:U593"><span class="mxinfo " id="T3:U594"><span class="var type1" id="S2T3U754">TEMPLATE</span>(<span class="mxinfo " id="T17:U596"><span class="mxinfo " id="T16:U597">1</span>:<span class="mxinfo " id="T16:U598"><span class="var type1" id="S3T16U758">H</span>+<span class="mxinfo " id="T6:U600">2</span></span></span>,<span class="mxinfo " id="T18:U601">:</span>)</span> = <span class="mxinfo " id="T6:U602">-<span class="mxinfo " id="T6:U603">180</span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="93,110" id="srcline110">110</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="93,111" id="srcline111">111</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
